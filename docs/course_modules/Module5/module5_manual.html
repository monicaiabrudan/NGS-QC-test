<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Manual – Genome Sequence Analysis Course</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../course_modules/Module5/module5_exercises.html" rel="next">
<link href="../../course_modules/Module5/module5.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../site_libs/quarto-contrib/quarto-project/img/WCS_Logo-Primary_Black.jpg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Genome Sequence Analysis Course</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../welcome.html"> 
<span class="menu-text">Learning paths</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-modules" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Modules</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-modules">    
        <li>
    <a class="dropdown-item" href="../../course_modules/Module1/module1.html">
 <span class="dropdown-text">File formats</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../course_modules/Module2/module2.html">
 <span class="dropdown-text">Reads alignment</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../course_modules/Module3/module3.html">
 <span class="dropdown-text">Variant calling</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../course_modules/Module4/module4.html">
 <span class="dropdown-text">Structural Variation Calling</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../course_modules/Module5/module5.html">
 <span class="dropdown-text">Genome assembly</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../course_modules/Module6/module6.html">
 <span class="dropdown-text">RNA-seq</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../course_modules/Module7/module7.html">
 <span class="dropdown-text">CHiP-Seq</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../course_modules/Glossary/glossary.html">
 <span class="dropdown-text">Glossary of terms</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-informatics-guide" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Informatics Guide</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-informatics-guide">    
        <li>
    <a class="dropdown-item" href="../../course_modules/VM_guide/VM_Guide.html">
 <span class="dropdown-text">How to setup a VM</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../course_modules/VM_guide/Software_list.html">
 <span class="dropdown-text">Software list</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-train-the-trainer" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Train-the-trainer</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-train-the-trainer">    
        <li>
    <a class="dropdown-item" href="../../course_modules/Train-the-trainer/introduction.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../course_modules/Train-the-trainer/strategies.html">
 <span class="dropdown-text">Strategies for training professionals</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../course_modules/Train-the-trainer/elements.html">
 <span class="dropdown-text">Elements of effective training</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../course_modules/Train-the-trainer/training_design.html">
 <span class="dropdown-text">Training design</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../course_modules/Module5/module5.html">Genome Assembly</a></li><li class="breadcrumb-item"><a href="../../course_modules/Module5/module5_manual.html">Manual</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">File formats</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module1/module1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module1/module1_manual.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Manual</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module1/module1_exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercises</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module1/module1_solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solutions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module1/module1_instructor_notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Instructor notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module1/module1_datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datasets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module1/module1_platform_guidance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Platform guidance</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Read alignment</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module2/module2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module2/module2_manual.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Manual</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module2/module2_exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercises</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module2/module2_solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solutions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module2/module2_instructor_notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Instructor notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module2/module2_datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datasets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module2/module2_platform_guidance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Platform guidance</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Variant calling</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module3/module3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module3/module3_manual.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Manual</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module3/module3_exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercises</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module3/module3_solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solutions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module3/module3_instructor_notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Instructor notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module3/module3_datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datasets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module3/module3_platform_guidance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Platform guidance</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Structural Variation Calling</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module4/module4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module4/module4_manual.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Manual</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module4/module4_exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercises</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module4/module4_solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solutions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module4/module4_instructor_notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Instructor notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module4/module4_datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datasets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module4/module4_platform_guidance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Platform guidance</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Genome Assembly</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module5/module5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module5/module5_manual.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Manual</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module5/module5_exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercises</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module5/module5_solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solutions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module5/module5_instructor_notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Instructor notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module5/module5_datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datasets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module5/module5_platform_guidance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Platform guidance</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">RNA-Seq</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module6/module6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module6/module6_manual.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Manual</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module6/module6_exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercises</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module6/module6_solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solutions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module6/module6_instructor_notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Instructor notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module6/module6_datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datasets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module6/module6_platform_guidance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Platform guidance</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">CHiP-Seq</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module7/module7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module7/module7_manual.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Manual</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module7/module7_exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercises</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module7/module7_solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solutions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module7/module7_instructor_notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Instructor notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module7/module7_datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datasets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module7/module7_platform_guidance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Platform guidance</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false">
 <span class="menu-text">How to setup a VM</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/VM_guide/VM_Guide.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Oracle VM VirtualBox Installation Guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/VM_guide/Software_list.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Software list</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false">
 <span class="menu-text">Train-the-trainer</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Train-the-trainer/introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Train-the-trainer/strategies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Strategies for training professionals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Train-the-trainer/elements.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Elements of effective training</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Train-the-trainer/training_design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Training design</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false">
 <span class="menu-text">Contributors</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../meet the team.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Acknowledgements</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview-of-genome-assembly" id="toc-overview-of-genome-assembly" class="nav-link active" data-scroll-target="#overview-of-genome-assembly">Overview of Genome Assembly</a>
  <ul class="collapse">
  <li><a href="#terminology" id="toc-terminology" class="nav-link" data-scroll-target="#terminology">Terminology</a></li>
  <li><a href="#pacific-biosciences-pacbio-sequencing" id="toc-pacific-biosciences-pacbio-sequencing" class="nav-link" data-scroll-target="#pacific-biosciences-pacbio-sequencing"><strong>Pacific Biosciences (PacBio) sequencing</strong></a></li>
  <li><a href="#nanopore-sequencing" id="toc-nanopore-sequencing" class="nav-link" data-scroll-target="#nanopore-sequencing"><strong>Nanopore sequencing</strong></a></li>
  <li><a href="#x-genomics" id="toc-x-genomics" class="nav-link" data-scroll-target="#x-genomics"><strong>10X Genomics</strong></a></li>
  <li><a href="#hi-c" id="toc-hi-c" class="nav-link" data-scroll-target="#hi-c"><strong>Hi-C</strong></a></li>
  <li><a href="#optical-mapping" id="toc-optical-mapping" class="nav-link" data-scroll-target="#optical-mapping">Optical mapping</a></li>
  <li><a href="#comparison-of-long-rage-technologies" id="toc-comparison-of-long-rage-technologies" class="nav-link" data-scroll-target="#comparison-of-long-rage-technologies">Comparison of long-rage technologies</a></li>
  <li><a href="#example-of-a-genome-project-workflow" id="toc-example-of-a-genome-project-workflow" class="nav-link" data-scroll-target="#example-of-a-genome-project-workflow">Example of a genome project workflow</a></li>
  <li><a href="#contig-generation" id="toc-contig-generation" class="nav-link" data-scroll-target="#contig-generation">Contig generation</a></li>
  <li><a href="#assembly-metrics" id="toc-assembly-metrics" class="nav-link" data-scroll-target="#assembly-metrics"><strong>Assembly Metrics</strong></a></li>
  <li><a href="#glossary" id="toc-glossary" class="nav-link" data-scroll-target="#glossary"><strong>Glossary</strong></a></li>
  <li><a href="#scaffolding" id="toc-scaffolding" class="nav-link" data-scroll-target="#scaffolding"><strong>Scaffolding</strong></a></li>
  <li><a href="#pseudochromosome-assignment" id="toc-pseudochromosome-assignment" class="nav-link" data-scroll-target="#pseudochromosome-assignment"><strong>(Pseudo)chromosome assignment</strong></a></li>
  <li><a href="#diploid-assembly" id="toc-diploid-assembly" class="nav-link" data-scroll-target="#diploid-assembly">Diploid assembly</a></li>
  <li><a href="#heterozygosity-and-allelic-duplication" id="toc-heterozygosity-and-allelic-duplication" class="nav-link" data-scroll-target="#heterozygosity-and-allelic-duplication">Heterozygosity and allelic duplication</a></li>
  <li><a href="#haplotype-duplication" id="toc-haplotype-duplication" class="nav-link" data-scroll-target="#haplotype-duplication"><strong>Haplotype duplication</strong></a></li>
  <li><a href="#falcon-phase" id="toc-falcon-phase" class="nav-link" data-scroll-target="#falcon-phase"><strong>FALCON-Phase</strong></a></li>
  <li><a href="#genome-assembly-quality-control-qc" id="toc-genome-assembly-quality-control-qc" class="nav-link" data-scroll-target="#genome-assembly-quality-control-qc"><strong>Genome assembly quality control (QC)</strong></a></li>
  <li><a href="#busco" id="toc-busco" class="nav-link" data-scroll-target="#busco"><strong>BUSCO</strong></a></li>
  <li><a href="#metagenomic-assembly" id="toc-metagenomic-assembly" class="nav-link" data-scroll-target="#metagenomic-assembly"><strong>Metagenomic assembly</strong></a></li>
  <li><a href="#transcriptome-assembly" id="toc-transcriptome-assembly" class="nav-link" data-scroll-target="#transcriptome-assembly"><strong>Transcriptome assembly</strong></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../course_modules/Module5/module5.html">Genome Assembly</a></li><li class="breadcrumb-item"><a href="../../course_modules/Module5/module5_manual.html">Manual</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Manual</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="overview-of-genome-assembly" class="level2">
<h2 class="anchored" data-anchor-id="overview-of-genome-assembly">Overview of Genome Assembly</h2>
<p>Genome assembly is the process of reconstructing an organism’s genome from millions or billions of short DNA sequences generated by sequencing technologies. Because current technologies cannot read entire chromosomes in one piece, genome assembly stitches these short reads together into longer continuous sequences that represent the genome. There are two main strategies for assembly: clone-based and whole-genome shotgun approaches. In the clone-based method, large DNA fragments are cloned, selected using genetic markers, and then sequenced individually to build the genome gradually. In contrast, the whole-genome shotgun approach involves randomly fragmenting the entire genome, sequencing all fragments, and using computational methods to assemble them into contiguous sequences. The ultimate goal is to produce an accurate, ideally complete, linear or circular representation of the genome.</p>
<p>When performing genome assembly, several key considerations influence the quality and accuracy of the final assembly. Sequencing coverage is critical—higher coverage improves assembly reliability and helps resolve ambiguities. However, errors in reads (particularly with long-read technologies) can complicate alignment and contig formation. Read length also plays a vital role; longer reads span repetitive regions more effectively, improving assembly continuity. The presence of repeats or non-unique regions in the genome poses major challenges, as they can lead to misassemblies or gaps. Additionally, factors like genome size, heterozygosity, and ploidy affect assembly complexity—larger or more variable genomes require more sophisticated algorithms. Finally, the computational resources—including runtime and memory usage—must be considered, especially for large or complex genomes, to ensure efficient and successful assembly.</p>
<section id="terminology" class="level3">
<h3 class="anchored" data-anchor-id="terminology">Terminology</h3>
<p><strong>Read:</strong> A short DNA sequence generated by a sequencing machine. Reads are the basic input for genome assembly.</p>
<p><strong>Contig:</strong> A <strong>contiguous stretch of assembled sequence</strong> formed by overlapping reads with no gaps. Represents the first level of genome assembly.</p>
<p><strong>Scaffold:</strong> An <strong>ordered set of contigs</strong> that are connected by gaps (usually filled with <strong>Ns</strong>) representing unknown or unsequenced regions. Scaffolds are often built using paired-end or long-range information.</p>
<p><strong>Gap (N):</strong> A placeholder for missing or unresolvable sequence in scaffolds. Represented by the letter “N” in assembled genomes.</p>
<p><strong>Chromosome:</strong> A complete DNA molecule, either linear or circular, containing a portion or all of the organism’s genome. The final goal of assembly is to reconstruct chromosomes or large portions of them from scaffolds.</p>
<p><strong>Sheared Fragment:</strong> A random piece of genomic DNA produced during sequencing library preparation by physically or enzymatically breaking the genome into smaller segments.</p>
<p><strong>Size Fractionation:</strong> A method to select DNA fragments of a particular length range, improving consistency of read lengths for sequencing.</p>
<p><strong>Supercontig:</strong> Another term for scaffold; a larger sequence formed by linking multiple contigs based on additional information such as read pairs or long reads.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/terminology.png" class="img-fluid figure-img" width="474"></p>
<figcaption><strong>Sequencing produces many short reads, which are first assembled into contigs—contiguous stretches of DNA without gaps. These contigs are then organized into larger structures called scaffolds, which are ordered sets of contigs separated by gaps filled with Ns to represent unknown sequences.</strong></figcaption>
</figure>
</div>
</section>
<section id="pacific-biosciences-pacbio-sequencing" class="level3">
<h3 class="anchored" data-anchor-id="pacific-biosciences-pacbio-sequencing"><strong>Pacific Biosciences (PacBio) sequencing</strong></h3>
<p>Pacific Biosciences (PacBio) sequencing technology relies on single-molecule real-time (SMRT) sequencing, where a single DNA molecule is sequenced by a single polymerase enzyme within a zero-mode waveguide (ZMW) well. As the polymerase incorporates nucleotides, each base emits a distinct color flash, allowing real-time base detection. Uniquely, methylated bases produce characteristic signal patterns, enabling detection of epigenetic modifications. The system has no theoretical limit on DNA fragment length, enabling long read sequencing. Key advantages include long read lengths, low systematic error, and the ability to generate high-accuracy consensus reads through circular consensus sequencing (CCS), where the same molecule is read multiple times. However, disadvantages include a high per-base error rate and higher sequencing costs. As of 2019, the Sequel II system significantly improved performance, offering an 8-fold increase in yield and enhanced CCS accuracy, producing HiFi reads with both long lengths and high fidelity.</p>
</section>
<section id="nanopore-sequencing" class="level3">
<h3 class="anchored" data-anchor-id="nanopore-sequencing"><strong>Nanopore sequencing</strong></h3>
<p>Nanopore sequencing, developed by Oxford Nanopore Technologies, offers a unique platform for real-time, portable DNA and RNA sequencing. Its key advantages include low capital cost, portability, and the ability to generate ultra-long reads, with lengths up to 1 megabase reported. The technology also enables the detection of base modifications (e.g., methylation) and can sequence RNA molecules directly, bypassing reverse transcription. These features make it particularly useful for de novo genome assembly, structural variant detection, and epigenetic studies. However, a major limitation is its high raw error rate, and it is particularly prone to systematic errors in homopolymer regions (stretches of the same base), which can affect accuracy in certain applications. Despite these challenges, nanopore sequencing continues to improve and provides valuable capabilities for field-based and large-scale genomic studies.</p>
</section>
<section id="x-genomics" class="level3">
<h3 class="anchored" data-anchor-id="x-genomics"><strong>10X Genomics</strong></h3>
<p>Read clouds, also known as linked-reads, provide a cost-effective way to obtain long-range sequencing information using standard short-read platforms. Technologies such as 10X Genomics Chromium generate barcoded libraries in which multiple short reads are derived from the same long (~100 kb) DNA fragment and tagged with a unique barcode. This allows researchers to group reads from the same molecule, enabling improved resolution of complex repeats, structural variants, and haplotypes, and facilitating more accurate scaffolding of genome assemblies. These “read clouds” are particularly useful for bridging large genomic gaps or repeats that cannot be resolved using conventional short reads. The ARCS tool, developed by Yeo et al.&nbsp;(2018), leverages linked-read data to scaffold genome assemblies and has been shown to significantly improve contiguity and assembly quality. Reference: Yeo S, Coombe L, Warren RL, Chu J, Birol I. (2018). ARCS: scaffolding genome drafts with linked reads. Bioinformatics, 34(5), 725–731. <a href="https://doi.org/10.1093/bioinformatics/btx675" class="uri">https://doi.org/10.1093/bioinformatics/btx675</a></p>
</section>
<section id="hi-c" class="level3">
<h3 class="anchored" data-anchor-id="hi-c"><strong>Hi-C</strong></h3>
<p>Hi-C is a powerful sequencing technique that captures the three-dimensional organization of chromatin through proximity ligation, linking DNA fragments that are spatially close in the nucleus. Although initially developed for studying chromatin architecture, Hi-C has proven highly effective for scaffolding genome assemblies, as most Hi-C interactions occur within the same chromosome, with a higher frequency between nearby regions. This spatial signal can be used to accurately order and orient contigs into chromosome-scale scaffolds. Automated scaffolding tools such as SALSA2 and 3D-DNA utilize Hi-C contact data for this purpose. Visualization tools like Juicer and HiGlass, and editing platforms such as Pretext, allow for manual inspection and refinement of genome assemblies based on Hi-C contact matrices. Reference: Dudchenko O, Batra SS, Omer AD, et al.&nbsp;(2017). De novo assembly of the Aedes aegypti genome using Hi-C yields chromosome-length scaffolds. Science, 356(6333), 92–95. <a href="https://doi.org/10.1126/science.aal3327" class="uri">https://doi.org/10.1126/science.aal3327</a></p>
</section>
<section id="optical-mapping" class="level3">
<h3 class="anchored" data-anchor-id="optical-mapping">Optical mapping</h3>
<p>Optical mapping is a genome analysis technique that uses high molecular weight DNA fragments to generate a physical map of the genome based on the location of specific sequence motifs. The process involves labeling short DNA motifs, linearizing the DNA molecules, and capturing high-resolution images to determine the spacing between labels. This method produces restriction digest maps that can span large regions of the genome and are especially useful for navigating repetitive regions, where traditional sequencing methods struggle. Optical mapping provides long-range genomic information, making it valuable for scaffolding assemblies, validating structural variants, and resolving complex genomic regions. Modern platforms like BioNano Genomics have scaled up this technology, enabling high-throughput, automated optical mapping for large genomes.</p>
<p>Reference: Lam ET, Hastie A, Lin C, et al.&nbsp;(2012). Genome mapping on nanochannel arrays for structural variation analysis and sequence assembly. Nature Biotechnology, 30(8), 771–776. <a href="https://doi.org/10.1038/nbt.2303" class="uri">https://doi.org/10.1038/nbt.2303</a></p>
</section>
<section id="comparison-of-long-rage-technologies" class="level3">
<h3 class="anchored" data-anchor-id="comparison-of-long-rage-technologies">Comparison of long-rage technologies</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/long range technologies.png" class="img-fluid figure-img" width="590"></p>
<figcaption><strong>Long range technologies. The bar chart shows the contributions of PacBio subreads (&gt;1 kb) (black), 10X Genomics linked-reads (green), and two BioNano optical mapping chemistries: BspQI/BssSI (light blue) and DLE1 (dark blue), used for scaffolding and assembly enhancement. Log-scaled x-axis represents scaffold N50 length (a common assembly continuity metric). BioNano DLE1 technology consistently produces the longest scaffold N50s, demonstrating its effectiveness in generating chromosome-scale assemblies when integrated with other technologies.</strong></figcaption>
</figure>
</div>
</section>
<section id="example-of-a-genome-project-workflow" class="level3">
<h3 class="anchored" data-anchor-id="example-of-a-genome-project-workflow">Example of a genome project workflow</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/genome project workflow.png" class="img-fluid figure-img" width="619"></p>
<figcaption><strong>An example of a genome project workflow. PacBio long reads are used for initial contigging and purging; 10X Genomics linked reads, BioNano optical mapping, and Hi-C chromatin interaction data are used sequentially for scaffolding. The right panel shows downstream steps: gap-filling and polishing using long reads to improve sequence continuity and correct base errors; manual curation using read depth and annotation tracks; and finally, the generation of a primary assembly with alternate haplotypes. Together, these steps produce chromosome-scale, highly accurate genome assemblies.</strong></figcaption>
</figure>
</div>
</section>
<section id="contig-generation" class="level3">
<h3 class="anchored" data-anchor-id="contig-generation">Contig generation</h3>
<p>Contig generation is the first step in genome assembly, where overlapping sequencing reads are stitched together into continuous sequences. Two primary strategies are used: Overlap-Layout-Consensus (OLC) and de Bruijn Graph (DBG). The OLC approach identifies overlaps between all pairs of reads, builds a layout graph based on these overlaps, and derives consensus sequences to form contigs. While effective for long reads, OLC is computationally intensive due to its quadratic scaling with the number of reads. Assemblers like Falcon, Canu, and minimap/miniasm are widely used for long-read data (PacBio, ONT). The DBG method, commonly used for short-read data, constructs a graph from all k-mers (subsequences of length k) found in the dataset, and uses this structure to assemble contigs. Tools like Velvet, ABySS, SPAdes, and wtdbg2 implement this approach. Both methods face challenges from heterozygosity, sequencing errors, repeats, low-complexity regions, and base composition or sequencing biases, all of which can complicate accurate contig generation.</p>
</section>
<section id="assembly-metrics" class="level3">
<h3 class="anchored" data-anchor-id="assembly-metrics"><strong>Assembly Metrics</strong></h3>
<p>Assembly Metrics are key quantitative measures used to assess the quality and completeness of a genome assembly. Important metrics include the total assembly length, the number of sequences (both contigs and scaffolds), and the average, largest, and smallest sequence lengths. A commonly used statistic is the N50, which represents the length X such that 50% of the total assembly is contained in contigs or scaffolds of at least that length—indicating the assembly’s continuity. NG50 is a related metric, but is calculated with respect to the expected genome size, making it more informative for comparing assemblies of different organisms. Another important measure is gene content, which refers to the percentage of conserved core genes (e.g., using BUSCO or CEGMA) that are present and correctly assembled, giving insight into the assembly’s biological completeness.</p>
</section>
<section id="glossary" class="level3">
<h3 class="anchored" data-anchor-id="glossary"><strong>Glossary</strong></h3>
<p><strong>Total Length:</strong> The combined length of all contigs or scaffolds in the genome assembly.</p>
<p><strong>Contig:</strong> A contiguous sequence assembled from reads without gaps.</p>
<p><strong>Scaffold:</strong> An ordered set of contigs linked by additional data (e.g., paired-end reads), with gaps often filled by Ns.</p>
<p><strong>N50:</strong> The length <em>X</em> such that 50% of the assembly is contained in contigs or scaffolds of length ≥ <em>X</em>.</p>
<p><strong>NG50:</strong> A variant of N50 that is calculated using the <strong>expected genome size</strong> rather than the total assembly length.</p>
<p><strong>Gene Content:</strong> The percentage of conserved single-copy genes (e.g., from BUSCO datasets) present in the assembly, used to assess completeness.</p>
<p><strong>Average Length:</strong> The mean length of all contigs or scaffolds in the assembly.</p>
<p><strong>Largest/Smallest Sequence:</strong> The lengths of the longest and shortest contig or scaffold in the assembly.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/N50.png" class="img-fluid figure-img" width="227"></p>
<figcaption><strong>N50</strong></figcaption>
</figure>
</div>
</section>
<section id="scaffolding" class="level3">
<h3 class="anchored" data-anchor-id="scaffolding"><strong>Scaffolding</strong></h3>
<p>Scaffolding is a crucial step in genome assembly that aims to order and orient contigs into larger, more complete sequences called scaffolds. To achieve this, sequencing libraries with varying insert sizes are constructed. These range from short insert libraries (e.g., 2–6 kb), to intermediate (10–40 kb), and even large insert libraries (&gt;100 kb). By sequencing the ends of these longer fragments, researchers obtain information on the relative positions and orientations of contigs. Various sources of scaffolding evidence include Illumina mate-pair libraries, fosmid ends, bacterial artificial chromosomes (BACs), 10X Genomics linked reads, Hi-C proximity ligation data, and optical maps. During scaffolding, contigs are connected with gaps represented by Ns, indicating unknown sequences that separate the contigs but are supported by spatial linkage information. This process helps improve assembly continuity and bring the genome closer to its true chromosomal structure.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/scaffolding.png" class="img-fluid figure-img" width="489"></p>
<figcaption><strong>Scaffolding</strong></figcaption>
</figure>
</div>
</section>
<section id="pseudochromosome-assignment" class="level3">
<h3 class="anchored" data-anchor-id="pseudochromosome-assignment"><strong>(Pseudo)chromosome assignment</strong></h3>
<p>(Pseudo)chromosome assignment refers to the process of assembling scaffolds into chromosome-scale sequences, often referred to as pseudomolecules. This step is essential for organizing genome assemblies into biologically meaningful units that reflect true chromosome structure. The process relies on external sources of evidence such as a closely related reference genome, outgroup genomes, or genetic maps with markers. One commonly used tool for this purpose is RACA (Reference-Assisted Chromosome Assembly), which integrates data from a reference genome, a de novo assembly, and one or more outgroup genomes. RACA works by identifying syntenic fragments—conserved blocks of sequence across species—and then computes the likelihood of scaffold adjacencies based on evolutionary conservation and assembly data. This results in chromosome-scale assemblies even in species where true karyotypes are unavailable, facilitating downstream comparative genomics and annotation.</p>
<p><strong>Reference:</strong> Kim J, Larkin DM, Cai Q, et al.&nbsp;(2013). Reference-assisted chromosome assembly. <em>Proceedings of the National Academy of Sciences</em>, 110(5), 1785–1790. <a href="https://doi.org/10.1073/pnas.1220349110" class="uri">https://doi.org/10.1073/pnas.1220349110</a></p>
</section>
<section id="diploid-assembly" class="level3">
<h3 class="anchored" data-anchor-id="diploid-assembly">Diploid assembly</h3>
<p>Most traditional genome assemblers operate under the assumption that the genome is haploid, meaning they aim to produce a single, consensus sequence while ignoring allelic variation between the two parental chromosomes. This simplification can mask biologically important differences, especially in highly heterozygous organisms. In contrast, diploid assembly seeks to reconstruct both sets of chromosomes separately, generating two haplotype-phased genomes that preserve the unique sequence of each parental lineage. This approach improves the resolution of heterozygous variants, structural differences, and gene content across haplotypes. Tools such as Falcon-unzip have been developed for this purpose, using long-read data to identify phase blocks and separate haplotypes during the assembly process. Diploid assembly is particularly valuable in studies of genetic diversity, disease allele discovery, and functional genomics.</p>
<p>Reference: Chin CS, Peluso P, Sedlazeck FJ, et al.&nbsp;(2016). Phased diploid genome assembly with single-molecule real-time sequencing. Nature Methods, 13(12), 1050–1054. <a href="https://doi.org/10.1038/nmeth.4035" class="uri">https://doi.org/10.1038/nmeth.4035</a></p>
</section>
<section id="heterozygosity-and-allelic-duplication" class="level3">
<h3 class="anchored" data-anchor-id="heterozygosity-and-allelic-duplication">Heterozygosity and allelic duplication</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Heterozygosity and allelic duplication.png" class="img-fluid figure-img" width="671"></p>
<figcaption><strong>Heterozygosity and allelic duplication. The bar graph shows assembled genome size as a percentage of the expected genome size for various species (black = primary assembly, blue = alternate haplotigs), plotted alongside heterozygosity rates (grey line). Assemblies with higher heterozygosity tend to include more alternate haplotigs, resulting in a total assembly size greater than 100%. The top panel illustrates how diploid assembly captures both primary and alternate haplotypes. The diagram at right shows how low heterozygosity regions are collapsed into a single contig, while high heterozygosity regions are resolved into separate primary (p-contig) and alternate (h-contig) sequences. Data from Chin et al., Nature Methods (2016). <a href="https://doi.org/10.1038/nmeth.4035" class="uri">https://doi.org/10.1038/nmeth.4035</a></strong></figcaption>
</figure>
</div>
</section>
<section id="haplotype-duplication" class="level3">
<h3 class="anchored" data-anchor-id="haplotype-duplication"><strong>Haplotype duplication</strong></h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/haplotype duplication.png" class="img-fluid figure-img" width="478"></p>
<figcaption><strong>Haplotype duplication</strong></figcaption>
</figure>
</div>
<p>Haplotype duplication represents a common challenge in assembling high-heterozygosity diploid genomes. Assemblers like Falcon-unzip may unintentionally include both haplotypes in the primary assembly, leading to allelic duplication and overestimation of genome size. The tool purge_haplotigs helps resolve this by identifying these redundant sequences (called haplotigs) and relocating them to a separate bin, improving the representation of the true haploid genome. In addition, Falcon-phase uses Hi-C data to properly phase the assembly by switching segments between the primary and alternate haplotypes to reflect accurate inheritance. These tools work together to reduce redundancy and improve the structural and biological correctness of genome assemblies. For more details, see:</p>
<p>References:</p>
<ul>
<li>Roach MJ, Schmidt SA, Borneman AR. (2018). <em>Purge Haplotigs: Synteny Reduction for Third-gen Diploid Genome Assemblies</em>. <a href="https://doi.org/10.1186/s13059-018-1564-6" class="uri">https://doi.org/10.1186/s13059-018-1564-6</a></li>
<li>Guan D et al.&nbsp;(2020). <em>Identifying and removing haplotypic duplication in primary genome assemblies</em>. <em>Bioinformatics</em>, 36(9), 2896–2898. <a href="https://doi.org/10.1093/bioinformatics/btaa025" class="uri">https://doi.org/10.1093/bioinformatics/btaa025</a></li>
</ul>
</section>
<section id="falcon-phase" class="level3">
<h3 class="anchored" data-anchor-id="falcon-phase"><strong>FALCON-Phase</strong></h3>
<p>FALCON-Phase is a genome phasing tool designed to resolve diploid genomes by combining long-read sequencing data (e.g., from PacBio) with Hi-C chromatin contact data. While tools like FALCON-Unzip can separate haplotypes locally using SNP information from long reads, FALCON-Phase extends phasing over longer genomic distances by using Hi-C’s long-range linkage information. The process involves several steps: (1) FALCON-Unzip generates primary contigs and associated haplotigs; (2) haplotigs are aligned back to their positions on the primary contig; (3) the sequence is “minced” into phased blocks; (4) Hi-C reads are mapped to these blocks; (5) a phasing algorithm determines which haplotigs belong to each haplotype based on contact patterns; and (6) the tool emits two phased haplotigs—phase 0 and phase 1—representing the maternal and paternal chromosomes. This process improves the accuracy and completeness of haplotype-resolved assemblies, particularly in regions of high heterozygosity.</p>
<p>Reference:&nbsp;Kronenberg ZN et al.&nbsp;(2021). Extended haplotype-phasing of long-read de novo genome assemblies using Hi-C. <a href="https://www.nature.com/articles/s41467-020-20536-y" class="uri">https://www.nature.com/articles/s41467-020-20536-y</a></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/FALCON-Phase.png" class="img-fluid figure-img" width="410"></p>
<figcaption><strong>FALCON-Phase</strong></figcaption>
</figure>
</div>
</section>
<section id="genome-assembly-quality-control-qc" class="level3">
<h3 class="anchored" data-anchor-id="genome-assembly-quality-control-qc"><strong>Genome assembly quality control (QC)</strong></h3>
<p>Genome assembly quality control (QC) is a critical step in ensuring the accuracy, completeness, and usability of assembled genomes. One important metric is base accuracy, which can be assessed by realigning reads from the same species and identifying SNPs and indels—with indels often being more frequent in PacBio and Nanopore assemblies. Tools like KAT can evaluate k-mer completeness using Illumina data to estimate how much of the expected sequence content is present in the assembly. Local structural accuracy can be assessed using external evidence, such as read alignment patterns (via tools like REAPR or QUAST) or through known physical linkages like PCR-validated adjacencies. Another key QC aspect is gene content, which involves verifying the order and orientation of genes and exons, especially for well-characterized genes such as housekeeping genes.</p>
</section>
<section id="busco" class="level3">
<h3 class="anchored" data-anchor-id="busco"><strong>BUSCO</strong></h3>
<p>BUSCO (Benchmarking Universal Single-Copy Orthologs) is a widely used tool for evaluating the completeness of genome assemblies, transcriptomes, and gene annotations. It works by identifying a set of evolutionarily conserved genes that are expected to be present as single copies in nearly all species within a specific clade. BUSCO scans the input dataset to detect these orthologs and classifies them as Complete (C), Duplicated (D), Fragmented (F), or Missing (M). A high percentage of complete single-copy genes indicates a high-quality and complete assembly. The BUSCO pipeline combines tBLASTn, Augustus gene prediction, and HMMER3 profile searches to accurately locate and classify each ortholog, and can be run on genome assemblies, transcriptome data, or gene sets. It has become a standard benchmark for genome quality assessment in both de novo assembly and annotation pipelines.</p>
<p>Reference: Simão FA, Waterhouse RM, Ioannidis P, Kriventseva EV, Zdobnov EM. (2015). BUSCO: assessing genome assembly and annotation completeness with single-copy orthologs. Bioinformatics, 31(19), 3210–3212. <a href="https://doi.org/10.1093/bioinformatics/btv351" class="uri">https://doi.org/10.1093/bioinformatics/btv351</a></p>
</section>
<section id="metagenomic-assembly" class="level3">
<h3 class="anchored" data-anchor-id="metagenomic-assembly"><strong>Metagenomic assembly</strong></h3>
<p>Metagenomic assembly involves reconstructing genomic sequences from DNA extracted from complex environmental samples, typically containing multiple uncultured microbial species. Unlike traditional genome assembly, metagenomic assembly must address the challenge of mixed organisms with varying abundance levels, making it difficult to distinguish low-abundance genomes from sequencing errors or contaminants. Additionally, sequence divergence across species and strain-level variation adds complexity to assembly and binning. The typical output is a collection of contigs with associated coverage information, which provides a simplified yet informative representation of the community’s genetic content. However, assembling complete genomes is often difficult, and scaffolding approaches must be carefully selected or adapted to avoid chimeric assemblies. Some recent methods integrate abundance profiles, sequence composition, and differential coverage across samples to improve binning and contig linkage. New strategies are discussed by Ayling et al.&nbsp;(2019), who review tools and frameworks designed specifically for short-read metagenomic assembly and highlight the need for scalable, hybrid approaches.<br>
</p>
<p>Reference: Ayling M, Clark MD, Leggett RM. (2019). New approaches for metagenome assembly with short reads. Brief Bioinform. <a href="https://doi.org/10.1093/bib/bbz020" class="uri">https://doi.org/10.1093/bib/bbz020</a></p>
</section>
<section id="transcriptome-assembly" class="level3">
<h3 class="anchored" data-anchor-id="transcriptome-assembly"><strong>Transcriptome assembly</strong></h3>
<p>Transcriptome assembly focuses on reconstructing expressed RNA sequences (cDNA) from a biological sample, rather than the entire genome. This form of assembly is complicated by the fact that, like in metagenomics, there is no single linear reference sequence—instead, it must handle a diverse and dynamic set of transcripts. The varying abundance of transcripts, along with alternative splicing, results in complex branching structures during assembly. Transcriptome assemblers must distinguish true isoforms from assembly errors and resolve exon skipping, intron retention, and other splicing events to accurately reconstruct full-length transcripts. De novo transcriptome assembly tools, such as Trinity, address this by using k-mer graphs to represent transcript variation. The resulting transcript contigs can then be quantified, annotated, and used for downstream analyses like differential expression, even in species lacking a reference genome.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../course_modules/Module5/module5.html" class="pagination-link" aria-label="Overview">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Overview</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../course_modules/Module5/module5_exercises.html" class="pagination-link" aria-label="Exercises">
        <span class="nav-page-text">Exercises</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>This work is licensed under a Creative Commons Attribution 4.0 International License. Reuse is encouraged with acknowledgement</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>