<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Manual – NGS Bioinformatics course</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../course_modules/Module3/module3_exercises.html" rel="next">
<link href="../../course_modules/Module2/module2_exercises.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">NGS Bioinformatics course</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-modules" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Modules</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-modules">    
        <li>
    <a class="dropdown-item" href="../../course_modules/Module1/module1.html">
 <span class="dropdown-text">File formats</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../course_modules/Module2/module2.html">
 <span class="dropdown-text">Reads alignment</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../course_modules/Module3/module3.html">
 <span class="dropdown-text">Variant calling</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../course_modules/Module4/module4.html">
 <span class="dropdown-text">Structural Variation Calling</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../course_modules/Module5/module5.html">
 <span class="dropdown-text">Genome assembly</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../course_modules/Module6/module6.html">
 <span class="dropdown-text">RNA-seq</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../course_modules/Module7/module7.html">
 <span class="dropdown-text">CHiP-Seq</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../course_modules/Module3/module3_manual.html">Variant calling</a></li><li class="breadcrumb-item"><a href="../../course_modules/Module3/module3_manual.html">Manual</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">File formats</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module1/module1_manual.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Manual</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module1/module1_exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercises</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Read alignment</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module2/module2_manual.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Manual</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module2/module2_exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercises</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Variant calling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module3/module3_manual.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Manual</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module3/module3_exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercises</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Structural Variation Calling</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module4/module4_manual.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Manual</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module4/module4_exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercises</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Genome Assembly</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module5/module5_manual.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Manual</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module5/module5_exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercises</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">RNA-Seq</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module6/module6_manual.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Manual</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module6/module6_exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercises</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">CHiP-Seq</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module7/module7_manual.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Manual</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module7/module7_exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercises</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#section" id="toc-section" class="nav-link active" data-scroll-target="#section"></a>
  <ul class="collapse">
  <li><a href="#introduction-and-learning-outcomes" id="toc-introduction-and-learning-outcomes" class="nav-link" data-scroll-target="#introduction-and-learning-outcomes">1. Introduction and Learning Outcomes</a></li>
  <li><a href="#dna-variations-definitions-and-types" id="toc-dna-variations-definitions-and-types" class="nav-link" data-scroll-target="#dna-variations-definitions-and-types">2. DNA Variations: Definitions and Types</a></li>
  <li><a href="#how-to-dna-sequences-change" id="toc-how-to-dna-sequences-change" class="nav-link" data-scroll-target="#how-to-dna-sequences-change">How to DNA sequences change?</a></li>
  <li><a href="#germline-versus-somatic-mutations" id="toc-germline-versus-somatic-mutations" class="nav-link" data-scroll-target="#germline-versus-somatic-mutations">Germline versus somatic mutations</a></li>
  <li><a href="#types-of-genomic-variations" id="toc-types-of-genomic-variations" class="nav-link" data-scroll-target="#types-of-genomic-variations">Types of genomic variations</a></li>
  <li><a href="#structural-variants" id="toc-structural-variants" class="nav-link" data-scroll-target="#structural-variants">Structural variants</a></li>
  <li><a href="#small-nucleotide-variants-snvs" id="toc-small-nucleotide-variants-snvs" class="nav-link" data-scroll-target="#small-nucleotide-variants-snvs">Small nucleotide variants (SNVs)</a></li>
  <li><a href="#ancestral-and-derived-alleles" id="toc-ancestral-and-derived-alleles" class="nav-link" data-scroll-target="#ancestral-and-derived-alleles"><strong>Ancestral and derived alleles</strong></a></li>
  <li><a href="#microsatellites-or-short-tandem-repeats-strs" id="toc-microsatellites-or-short-tandem-repeats-strs" class="nav-link" data-scroll-target="#microsatellites-or-short-tandem-repeats-strs"><strong>Microsatellites</strong> or <strong>Short Tandem Repeats (STRs)</strong></a></li>
  <li><a href="#snps-vs-strs" id="toc-snps-vs-strs" class="nav-link" data-scroll-target="#snps-vs-strs"><strong>SNPs vs STRs</strong></a></li>
  <li><a href="#genetic-makeup-of-an-individual" id="toc-genetic-makeup-of-an-individual" class="nav-link" data-scroll-target="#genetic-makeup-of-an-individual"><strong>Genetic makeup of an individual</strong></a></li>
  <li><a href="#practical-applications-of-variant-calling" id="toc-practical-applications-of-variant-calling" class="nav-link" data-scroll-target="#practical-applications-of-variant-calling">3. Practical Applications of Variant Calling</a></li>
  <li><a href="#how-do-we-detect-change" id="toc-how-do-we-detect-change" class="nav-link" data-scroll-target="#how-do-we-detect-change">How do we detect change?</a></li>
  <li><a href="#variant-calling-basics" id="toc-variant-calling-basics" class="nav-link" data-scroll-target="#variant-calling-basics">4. Variant Calling Basics</a></li>
  <li><a href="#the-variant-call-format-vcf" id="toc-the-variant-call-format-vcf" class="nav-link" data-scroll-target="#the-variant-call-format-vcf">The <strong>Variant Call Format (VCF)</strong></a></li>
  <li><a href="#allelic-depth" id="toc-allelic-depth" class="nav-link" data-scroll-target="#allelic-depth"><strong>Allelic depth</strong></a></li>
  <li><a href="#germline-versus-somatic-mutations-1" id="toc-germline-versus-somatic-mutations-1" class="nav-link" data-scroll-target="#germline-versus-somatic-mutations-1"><strong>Germline versus somatic mutations</strong></a></li>
  <li><a href="#naive-variant-calling-versus-fixed-allele-thresholds" id="toc-naive-variant-calling-versus-fixed-allele-thresholds" class="nav-link" data-scroll-target="#naive-variant-calling-versus-fixed-allele-thresholds"><strong>Naive variant calling versus fixed allele thresholds</strong></a></li>
  <li><a href="#base-quality-filtering" id="toc-base-quality-filtering" class="nav-link" data-scroll-target="#base-quality-filtering"><strong>Base Quality Filtering</strong></a></li>
  <li><a href="#variant-calling-models" id="toc-variant-calling-models" class="nav-link" data-scroll-target="#variant-calling-models">Variant calling models</a></li>
  <li><a href="#steps-in-variant-detection" id="toc-steps-in-variant-detection" class="nav-link" data-scroll-target="#steps-in-variant-detection">5. Steps in Variant Detection</a></li>
  <li><a href="#common-sources-of-error" id="toc-common-sources-of-error" class="nav-link" data-scroll-target="#common-sources-of-error">6. Common Sources of Error</a></li>
  <li><a href="#advanced-topics-in-variant-calling" id="toc-advanced-topics-in-variant-calling" class="nav-link" data-scroll-target="#advanced-topics-in-variant-calling">7. Advanced Topics in Variant Calling</a></li>
  <li><a href="#assessing-and-benchmarking-variant-calls" id="toc-assessing-and-benchmarking-variant-calls" class="nav-link" data-scroll-target="#assessing-and-benchmarking-variant-calls">8. Assessing and Benchmarking Variant Calls</a></li>
  <li><a href="#functional-annotation-and-variant-consequences" id="toc-functional-annotation-and-variant-consequences" class="nav-link" data-scroll-target="#functional-annotation-and-variant-consequences">9. Functional Annotation and Variant Consequences</a></li>
  <li><a href="#population-level-variant-data" id="toc-population-level-variant-data" class="nav-link" data-scroll-target="#population-level-variant-data">10. Population-Level Variant Data</a></li>
  <li><a href="#references-and-additional-resources" id="toc-references-and-additional-resources" class="nav-link" data-scroll-target="#references-and-additional-resources">11. References and Additional Resources</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../course_modules/Module3/module3_manual.html">Variant calling</a></li><li class="breadcrumb-item"><a href="../../course_modules/Module3/module3_manual.html">Manual</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Manual</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section"></h2>
<section id="introduction-and-learning-outcomes" class="level3">
<h3 class="anchored" data-anchor-id="introduction-and-learning-outcomes">1. Introduction and Learning Outcomes</h3>
<p>By the end of this module, you should be able to:</p>
<ul>
<li>Understand various types of variation and how they are ascertained.</li>
<li>Understand how variant calls are made.</li>
<li>Assess variant quality and visualise variants.</li>
<li>Annotate variants and assess consequences.</li>
</ul>
</section>
<section id="dna-variations-definitions-and-types" class="level3">
<h3 class="anchored" data-anchor-id="dna-variations-definitions-and-types">2. DNA Variations: Definitions and Types</h3>
<p>Mutations refer to any alteration in the DNA base sequence and can be broadly classified into germline and somatic mutations.</p>
</section>
<section id="how-to-dna-sequences-change" class="level3">
<h3 class="anchored" data-anchor-id="how-to-dna-sequences-change">How to DNA sequences change?</h3>
</section>
<section id="germline-versus-somatic-mutations" class="level3">
<h3 class="anchored" data-anchor-id="germline-versus-somatic-mutations">Germline versus somatic mutations</h3>
<p>Germline mutations occur in the egg or sperm cells and are heritable, meaning they can be passed on to subsequent generations. In contrast, somatic mutations arise in non-germline tissues and do not get inherited by offspring.</p>
<p>DNA replication errors are changes introduced into the genome during the process of cell division. These include <strong>de novo replication errors</strong>, mistakes made when DNA is copied, as well as structural changes such as <strong>recombination</strong>, <strong>gene conversion</strong>, and <strong>transposition</strong>. Additionally, <strong>non-replicative DNA damage</strong> can occur due to <strong>chemical exposure</strong> or <strong>radiation</strong>, independently of cell division. In <strong>sexually reproducing organisms</strong>, such mutations are only <strong>heritable</strong> if they occur in the <strong>gametes</strong> (sperm or egg cells), allowing them to be passed on to the next generation. Understanding the sources of these errors is crucial for studying genetic variation and disease.</p>
</section>
<section id="types-of-genomic-variations" class="level3">
<h3 class="anchored" data-anchor-id="types-of-genomic-variations">Types of genomic variations</h3>
<p>When examining the types of genomic variations, it is essential to differentiate between large-scale and small-scale changes. Large-scale variations include chromosomal gains or losses (such as aneuploidies), various forms of translocations (for instance, reciprocal and Robertsonian), and copy number variants (CNVs), which are duplications or deletions typically ranging from approximately 1 kilobase to several megabases—collectively accounting for roughly 12% of the human genome.</p>
<p>Structural variants (SVs), including insertions, inversions, translocations, and tandem duplications larger than 50 base pairs, also fall into this category. On the other hand, small-scale variations involve more subtle changes such as single nucleotide variants (SNVs), which are simple base substitutions (for example, A→C or G→T), indels that represent small insertions or deletions (less than 50 base pairs), multinucleotide polymorphisms (MNPs) which involve multiple adjacent base substitutions, and microsatellites or short tandem repeats (STRs). STRs are characterized by the repetition of small motifs of 2–6 base pairs—like the “GATA” sequence repeated 7 versus 8 times—which are inherently more variable. Notably, while single nucleotide polymorphisms (SNPs) are usually biallelic with a relatively low mutation rate (around 10^-8 per base pair per generation), STRs are multiallelic with higher mutation rates, making their ancestral states more challenging to infer.</p>
<p>To summarise:</p>
<p><strong>Mutation / Variation</strong>: Any change in the DNA base sequence.</p>
<p><strong>Germline mutation</strong>: Heritable variation present in egg or sperm cells.</p>
<p><strong>Somatic mutation</strong>: Variation in non-germline tissues; not passed to offspring.</p>
<p><strong>Copy number variants (CNVs)</strong>: Duplications or deletions ranging from ~1 kb to many Mb, accounting for roughly 12% of the human genome.</p>
<p><strong>Structural Variants (SVs)</strong>: Insertions, inversions, translocations, tandem duplications, etc. (often &gt;50 bp).</p>
<p><strong>Single Nucleotide Variants (SNVs)</strong>: Base substitutions (A→C, G→T, etc.).</p>
<p><strong>Indels</strong>: Small insertions or deletions (&lt;50 bp).</p>
<p><strong>Multinucleotide Polymorphisms (MNPs):</strong> Multiple adjacent base substitutions.</p>
<p><strong>Microsatellites / STRs</strong>: Short-tandem repeats of 2–6 bp repeated multiple times (e.g., “GATA” repeated 7 vs 8 times).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/DNA variation.png" class="img-fluid figure-img" width="294"></p>
<figcaption><strong>DNA variation</strong></figcaption>
</figure>
</div>
<p><strong>Large-scale genomic variations</strong> refer to substantial alterations in the structure or quantity of genetic material within a cell. These include <strong>gain or loss of entire chromosomes</strong>, <strong>chromothripsis</strong> (massive chromosomal rearrangements occurring in a single event), <strong>translocations</strong>, and other <strong>structural variants (SVs)</strong>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/large scale variation.png" class="img-fluid figure-img" width="301"></p>
<figcaption><strong>Example of a large scale variation.</strong> This karyotype image shows <strong>trisomy 21</strong>, where three copies of chromosome 21 are present instead of the usual two. This <strong>large-scale chromosomal variation</strong> is characteristic of <strong>Down syndrome</strong> and illustrates how <strong>chromosome gain</strong> can lead to developmental and genetic disorders in humans.</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/copy number variation.png" class="img-fluid figure-img" width="211"></p>
<figcaption><strong>Copy number variation.</strong> This image illustrates a <strong>chromosomal duplication</strong>, a type of <strong>copy number variation (CNV)</strong>. A segment of the chromosome is duplicated, resulting in extra genetic material. Such duplications can affect gene dosage and lead to developmental disorders or disease, depending on the genes involved and the size of the duplicated region.</figcaption>
</figure>
</div>
<p>A key type of large-scale variation is <strong>Copy Number Variants (CNVs)</strong>, which involve abnormal numbers of copies of specific DNA segments. CNVs can span from around 1 kilobase to several megabases and collectively account for approximately <strong>12% of human genomic DNA</strong>. Structural variants are defined as DNA segments larger than 50 base pairs that differ from the reference genome in sequence <strong>content, order, or orientation</strong>, and they play a significant role in genetic diversity and disease susceptibility.</p>
</section>
<section id="structural-variants" class="level3">
<h3 class="anchored" data-anchor-id="structural-variants">Structural variants</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/structural variants.png" class="img-fluid figure-img" width="425"></p>
<figcaption><strong>Structural variants</strong></figcaption>
</figure>
</div>
<p><strong>Translocation:</strong> A structural variation in which a segment of DNA is moved from one chromosome to another, often involving two different chromosomes.</p>
<p><strong>Local Translocation:</strong> A DNA segment is relocated to a different position <strong>within the same chromosome</strong>, rather than between different chromosomes.</p>
<p><strong>Tandem Duplication:</strong> A type of duplication where the copied DNA segment is inserted <strong>directly adjacent</strong> to the original sequence.</p>
<p><strong>Dispersed Duplication:</strong> A duplicated DNA segment is inserted <strong>elsewhere in the genome</strong>, not next to the original sequence—can be on the same or different chromosome.</p>
<p><strong>VNTR (Variable Number Tandem Repeat):</strong> Short sequences of DNA that are repeated in a <strong>tandem array</strong>; the number of repeats varies among individuals and can be used in DNA fingerprinting.</p>
<p><strong>Deletion:</strong> A mutation in which a segment of DNA is <strong>missing or removed</strong>, potentially disrupting gene function or regulation.</p>
<p><strong>Novel Insertion:</strong> A new DNA segment not present in the reference genome is <strong>inserted</strong> into a genomic location.</p>
<p><strong>Repeat Insertion:</strong> Insertion of a <strong>repetitive DNA element</strong>, such as a transposable element or tandem repeat, into a new genomic location.</p>
<p><strong>Inversion:</strong> A structural variation in which a segment of a chromosome is <strong>reversed end to end</strong>, altering gene orientation and potentially affecting function.</p>
</section>
<section id="small-nucleotide-variants-snvs" class="level3">
<h3 class="anchored" data-anchor-id="small-nucleotide-variants-snvs">Small nucleotide variants (SNVs)</h3>
<p><strong>Small-scale variations</strong> refer to changes in the genome that affect a small number of base pairs. These include <strong>Single Nucleotide Variants (SNVs)</strong>, where a single base is altered. SNVs can be further classified as <strong>substitutions</strong> (commonly known as SNPs), <strong>insertions</strong>, or <strong>deletions</strong>, with the latter two grouped as <strong>indels</strong>. Variations can also involve multiple bases, such as <strong>multinucleotide polymorphisms (MNPs)</strong>, <strong>mini-satellites</strong>, and <strong>micro-satellites</strong>. These changes contribute to genetic diversity and can influence phenotype and disease. In diploid organisms, a variant is <strong>homozygous</strong> if both chromosomes carry the same base, and <strong>heterozygous</strong> if the bases differ. An <strong>allele</strong> refers to a specific version of a DNA sequence at a given <strong>locus</strong> in the genome.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/SNP.png" class="img-fluid figure-img" width="353"></p>
<figcaption><strong>Example of a SNP</strong></figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Insertion.png" class="img-fluid figure-img" width="355"></p>
<figcaption><strong>Example of an insertion</strong></figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Deletion.png" class="img-fluid figure-img" width="357"></p>
<figcaption><strong>Example of a deletion</strong></figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/MNP.png" class="img-fluid figure-img" width="358"></p>
<figcaption><strong>Example of a multi-nucleotide polymorphism</strong></figcaption>
</figure>
</div>
</section>
<section id="ancestral-and-derived-alleles" class="level3">
<h3 class="anchored" data-anchor-id="ancestral-and-derived-alleles"><strong>Ancestral and derived alleles</strong></h3>
<p><strong>Ancestral and derived alleles</strong> describe the evolutionary history of genetic variants. The <strong>ancestral allele</strong> represents the original state of a DNA sequence before any mutation occurred, while the <strong>derived allele</strong> is the new version that arose through mutation.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/ancestral alleles.png" class="img-fluid figure-img" width="430"></p>
<figcaption><strong>This image shows a G to A variant (rs80356779) in the <em>CPT1A</em> gene. Comparative sequence alignment across multiple primates indicates that G is the ancestral allele, conserved across species. The derived A allele is unique to some human populations, highlighting the use of evolutionary comparison to infer ancestral states.</strong></figcaption>
</figure>
</div>
</section>
<section id="microsatellites-or-short-tandem-repeats-strs" class="level3">
<h3 class="anchored" data-anchor-id="microsatellites-or-short-tandem-repeats-strs"><strong>Microsatellites</strong> or <strong>Short Tandem Repeats (STRs)</strong></h3>
<p><strong>Microsatellites</strong>, also known as <strong>Short Tandem Repeats (STRs)</strong>, are short, repetitive DNA sequences. The number of repeats varies between individuals, making them useful for genetic fingerprinting. However, the <strong>flanking regions</strong>—where <strong>PCR primers</strong> bind—are conserved, allowing reliable amplification across different samples for analysis and comparison.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/microsattelites.png" class="img-fluid figure-img" width="410"></p>
<figcaption><strong>Micro-satellites example.</strong></figcaption>
</figure>
</div>
</section>
<section id="snps-vs-strs" class="level3">
<h3 class="anchored" data-anchor-id="snps-vs-strs"><strong>SNPs vs STRs</strong></h3>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th><strong>SNPs</strong></th>
<th>STRs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Usually biallelic; Seldom recurrent.</td>
<td>Multiallelic</td>
</tr>
<tr class="even">
<td>Low mutation rate: 1-1.25 x 10-8 /bp/generation.</td>
<td>Higher mutation rate: 2 x 10-4 – 1.3 x 10-2 /marker/generation.</td>
</tr>
<tr class="odd">
<td>~ 3,000,000 in humans</td>
<td>~500,000 in humans</td>
</tr>
<tr class="even">
<td>Ancestral state deduced from an out-group.</td>
<td>Difficult to deduce.</td>
</tr>
</tbody>
</table>
</section>
<section id="genetic-makeup-of-an-individual" class="level3">
<h3 class="anchored" data-anchor-id="genetic-makeup-of-an-individual"><strong>Genetic makeup of an individual</strong></h3>
<p>In genetic analysis, we ascertain the <strong>genetic makeup of an individual</strong>, which refers to their specific DNA sequence. The <strong>human genome is diploid</strong>, meaning individuals inherit one set of chromosomes from each parent. A <strong>genotype</strong> describes the specific genetic constitution at a given position in the genome, while a <strong>haplotype</strong> refers to a group of linked variants (alleles) inherited together on the same chromosome segment. Haplotypes are particularly informative because they capture patterns of <strong>SNP co-occurrence</strong> and can often be represented as <strong>binary strings</strong>, with each position reflecting one of two possible alleles. Understanding genotypes and haplotypes is fundamental in population genetics, disease association studies, and ancestry inference.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Genotypes and haplotypes.png" class="img-fluid figure-img" width="478"></p>
<figcaption><strong>Genotypes and haplotypes.</strong> This image illustrates the distinction between <strong>genotypes</strong> and <strong>haplotypes</strong>, showing how <strong>phasing and imputation</strong> resolve which alleles are inherited together on the same chromosome. The process identifies paternal and maternal <strong>haplotypes</strong> from genotype data, enabling a clearer understanding of genetic inheritance and variation across linked loci.</figcaption>
</figure>
</div>
</section>
<section id="practical-applications-of-variant-calling" class="level3">
<h3 class="anchored" data-anchor-id="practical-applications-of-variant-calling">3. Practical Applications of Variant Calling</h3>
<p>Genetic data is essential for a wide range of applications that help us understand and utilize biological diversity. It enables <strong>disease diagnosis</strong> by identifying genetic mutations linked to specific conditions, supports <strong>genotype-phenotype association studies</strong> to uncover the genetic basis of traits, and advances <strong>pharmacogenomics</strong> by guiding personalized medicine based on genetic profiles. In <strong>DNA forensics</strong>, genetic markers are used for individual identification, while in <strong>population genetics</strong> and <strong>evolutionary studies</strong>, they reveal patterns of ancestry, migration, and species divergence. Additionally, <strong>marker-assisted selection</strong> leverages genetic information to improve breeding outcomes in agriculture by selecting individuals with desirable traits.</p>
</section>
<section id="how-do-we-detect-change" class="level3">
<h3 class="anchored" data-anchor-id="how-do-we-detect-change">How do we detect change?</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/genotyping.png" class="img-fluid figure-img" width="521"></p>
<figcaption><strong>The evolution of genotyping technologies</strong></figcaption>
</figure>
</div>
<p>This image above illustrates the evolution of <strong>genotyping technologies</strong>. Previously, genotyping was performed on a small scale using <strong>PCR amplification and agarose gel electrophoresis</strong>, which allowed detection of specific variants (e.g., A or C alleles) in <strong>hundreds of individuals</strong>. Today, high-throughput platforms such as the <strong>Affymetrix Human SNP Array 6.0</strong> and the <strong>Omni 5M Quad SNP Chip</strong> enable genotyping of <strong>millions of variants</strong> across <strong>thousands of individuals</strong> simultaneously. These modern microarray-based methods dramatically increase scale, efficiency, and data resolution, making them essential tools in large-scale genetic studies like genome-wide association studies (GWAS).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/next generation vs traditional.png" class="img-fluid figure-img" width="428"></p>
<figcaption><strong>Next generation sequencing versus Sanger sequencing</strong></figcaption>
</figure>
</div>
<p>The image above compares <strong>next-generation sequencing (NGS)</strong> and <strong>traditional Sanger sequencing</strong> in detecting a specific <strong>A &gt; C variant</strong>. The top panel shows NGS data with <strong>29X coverage</strong>, where multiple aligned reads consistently support the C allele at the variant position. The bottom panel displays a <strong>Sanger electropherogram</strong>, where the base change is visible as a peak shift at the same position. NGS offers higher throughput and greater coverage depth, allowing for more sensitive and accurate variant detection across the genome, while traditional sequencing is limited to single-gene or small-region analysis.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/gel image.png" class="img-fluid figure-img" width="505"></p>
<figcaption><strong>Gel image. This image shows an ABI 377 4% denaturing PAGE gel, used for analyzing microsatellite markers (STRs) in a DNA fragment analysis experiment. Different colors represent different markers: DYS19 and DYS388 (green), and DYS391 (blue), while TAMRA350 (red) serves as the internal lane standard for sizing. DNA fragments are separated by size in base pairs (bp), visible along the vertical axis. Each lane represents a different individual or sample, and the discrete colored bands indicate alleles of varying repeat lengths. This high-resolution method allows precise genotyping of STR loci, widely used in forensics, population genetics, and Y-chromosome haplotyping.</strong></figcaption>
</figure>
</div>
</section>
<section id="variant-calling-basics" class="level3">
<h3 class="anchored" data-anchor-id="variant-calling-basics">4. Variant Calling Basics</h3>
<p><strong>Variant calling</strong> is the process of identifying differences in DNA sequences by comparing a sample’s sequence to a <strong>reference genome</strong>. The goal is to determine the <strong>genotype</strong>—the specific combination of alleles—at each genomic position. In diploid organisms, which carry two copies of each chromosome, genotypes are classified as <strong>RR</strong> (homozygous reference), <strong>RA</strong> (heterozygous), or <strong>AA</strong> (homozygous alternate), based on whether the alleles match the reference (<strong>Ref</strong>) or differ (<strong>Alt</strong>). This analysis provides insight into an organism’s <strong>genetic makeup</strong>, enabling downstream applications such as disease association studies, ancestry inference, and personalized medicine.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/ref and alt alleles.png" class="img-fluid figure-img"></p>
<figcaption><strong>Reference and alternative alleles. This image illustrates how differences between a reference genome and a sequenced genome are represented in variant calling. Genotypes are shown with corresponding VCF notation (e.g., 0/0, 1/0, 1/1) and alternate allele dosage values (0, 1, 2), indicating homozygous reference, heterozygous, and homozygous alternate states, respectively.</strong></figcaption>
</figure>
</div>
</section>
<section id="the-variant-call-format-vcf" class="level3">
<h3 class="anchored" data-anchor-id="the-variant-call-format-vcf">The <strong>Variant Call Format (VCF)</strong></h3>
<p>The <strong>Variant Call Format (VCF)</strong> is a standardized text format used to store genetic variation data, including single nucleotide variants (SNVs), insertions, deletions, and structural variants. Each entry captures information about genomic position, reference and alternate alleles, quality metrics, and sample genotypes. Tools such as <strong>VCFTools</strong> (<a href="http://vcftools.sourceforge.net/" class="uri">http://vcftools.sourceforge.net/</a>) and <strong>vcfCTools</strong> (<a href="https://github.com/AlistairNWard/vcfCTools" class="uri">https://github.com/AlistairNWard/vcfCTools</a>) are widely used for processing, filtering, and analyzing VCF files.</p>
</section>
<section id="allelic-depth" class="level3">
<h3 class="anchored" data-anchor-id="allelic-depth"><strong>Allelic depth</strong></h3>
<p><strong>Allelic depth</strong> refers to the number of sequencing reads supporting each allele at a given genomic position. It is a key measure in variant calling, where <strong>variant depth</strong> typically indicates the <strong>average read coverage</strong> at that position, helping assess the confidence and reliability of the identified genetic variant.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/allelic depth.png" class="img-fluid figure-img" width="370"></p>
<figcaption><strong>Allelic depth</strong></figcaption>
</figure>
</div>
</section>
<section id="germline-versus-somatic-mutations-1" class="level3">
<h3 class="anchored" data-anchor-id="germline-versus-somatic-mutations-1"><strong>Germline versus somatic mutations</strong></h3>
<p><strong>Germline and somatic mutations</strong> differ in their origin and variant calling expectations. In <strong>germline variant calling</strong>, the alternate allele frequency (AF) typically aligns with predictable ratios: <strong>0.0</strong> for homozygous reference (RR), <strong>1.0</strong> for homozygous alternate (AA), and <strong>0.5</strong> for heterozygous (RA), with minor deviations due to sequencing errors and sampling variability. In contrast, <strong>somatic variant calling</strong>, often used in cancer genomics, must account for <strong>variable allele frequencies</strong>, as mutations can be <strong>subclonal</strong> (present in a subset of cells) and influenced by <strong>admixture of normal and tumor cells</strong>. This makes somatic variant detection more complex and requires sensitive analytical methods.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/somatic mutations.png" class="img-fluid figure-img" width="476"></p>
<figcaption><strong>Example of somatic mutations</strong></figcaption>
</figure>
</div>
</section>
<section id="naive-variant-calling-versus-fixed-allele-thresholds" class="level3">
<h3 class="anchored" data-anchor-id="naive-variant-calling-versus-fixed-allele-thresholds"><strong>Naive variant calling versus fixed allele thresholds</strong></h3>
<p><strong>Naive variant calling</strong> typically relies on straightforward interpretation of observed sequencing data, often assuming ideal conditions and using limited filtering or statistical modeling. In contrast, approaches using <strong>fixed allele thresholds</strong> apply predefined allele frequency cutoffs to assign genotypes—commonly using values like 0.0, 0.5, and 1.0 to denote homozygous reference, heterozygous, and homozygous alternate genotypes, respectively. While fixed thresholds simplify analysis, they may miss low-frequency variants or misclassify genotypes in noisy data, unlike more advanced methods that incorporate probabilistic models or quality metrics for greater accuracy.</p>
<p>There are several problems associated with traditional variant calling methods that rely on hard thresholds. First, they often <strong>undercall heterozygotes</strong>, especially in <strong>low-coverage data</strong>, where insufficient read depth can make it difficult to detect both alleles. Second, using <strong>fixed quality cutoffs</strong> may <strong>discard valuable information</strong>, potentially overlooking true variants that fall just below the threshold. Lastly, these methods typically <strong>provide no measure of confidence</strong>, making it difficult to assess the reliability of the genotype calls or prioritize variants for further analysis.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/fixed allele threshold.png" class="img-fluid figure-img" width="500"></p>
<figcaption><strong>Example of fixed allele threshold.</strong></figcaption>
</figure>
</div>
</section>
<section id="base-quality-filtering" class="level3">
<h3 class="anchored" data-anchor-id="base-quality-filtering"><strong>Base Quality Filtering</strong></h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/filter low base quality.png" class="img-fluid figure-img" width="466"></p>
<figcaption><strong>Image showing filtering low base quality</strong></figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/quality by cycle.png" class="img-fluid figure-img" width="330"></p>
<figcaption><strong>Image showing quality dropping with addition of more cycles</strong></figcaption>
</figure>
</div>
<p>Before calling genotypes, it is essential to filter out <strong>low-quality base calls</strong> to ensure accurate variant detection. Sequencing errors are more likely to occur at low-quality positions, which can lead to incorrect genotype assignments. Base quality is measured using the <strong>Phred quality score</strong>, where higher scores indicate greater confidence in the accuracy of the base call. For example, a Q20 score corresponds to a 1% error rate (accuracy of 99%), while Q30 represents a 0.1% error rate. In practice, bases with a <strong>quality score below Q20</strong> are typically excluded from analysis. The figure above shows how base quality filtering improves allelic count accuracy and genotype prediction. The accompanying plot of <strong>average quality by sequencing cycle</strong> illustrates a common pattern: base quality is highest at the start of sequencing and declines toward the end. Applying this filter helps reduce noise and increases the reliability of variant calling results.</p>
</section>
<section id="variant-calling-models" class="level3">
<h3 class="anchored" data-anchor-id="variant-calling-models">Variant calling models</h3>
<p>More sophisticated models apply a statistical framework</p>
<p><img src="images/formula1.png" class="img-fluid" width="296"></p>
<p>To determine: 1. the most likely genotype g ∈ {RR, RA, AA} given the observed data D</p>
<p><img src="images/formula3.png" class="img-fluid" width="176"></p>
<ol start="2" type="1">
<li>and the genotype quality</li>
</ol>
<p><img src="images/formula2.png" class="img-fluid" width="157"></p>
<p><img src="images/formula4.png" class="img-fluid" width="266"></p>
</section>
<section id="steps-in-variant-detection" class="level3">
<h3 class="anchored" data-anchor-id="steps-in-variant-detection">5. Steps in Variant Detection</h3>
</section>
<section id="common-sources-of-error" class="level3">
<h3 class="anchored" data-anchor-id="common-sources-of-error">6. Common Sources of Error</h3>
</section>
<section id="advanced-topics-in-variant-calling" class="level3">
<h3 class="anchored" data-anchor-id="advanced-topics-in-variant-calling">7. Advanced Topics in Variant Calling</h3>
<p><strong>Somatic variant calling</strong> specifically aims to identify genetic variants present in tumor cells by comparing sequences from tumor samples against matched normal tissues. The primary objective is detecting mutations that may drive cancer progression. Because tumors are heterogeneous, subclonal variants—mutations present in only a subset of cells—often exhibit widely varying allele fractions, complicating their detection and interpretation. Specialized bioinformatics pipelines such as Mutect2 and Strelka2 have been developed to address these complexities and accurately distinguish true somatic mutations from background noise.</p>
<p><strong>Indel calling presents unique challenges</strong>, notably due to elevated sequencing error rates in regions such as microsatellites and homopolymers, where accurate base calling is particularly difficult. Additionally, indels can be represented in multiple valid ways by different alignment tools, leading to inconsistencies in their annotation and interpretation. As a result, complex indel regions often suffer from low reproducibility, with significant discrepancies observed across different variant callers. Users are encouraged to validate indel calls rigorously, especially in clinical or sensitive research contexts.</p>
<p><strong>Emerging approaches in variant calling</strong> are addressing these limitations. Local de novo assembly methods, implemented in tools like GATK’s HaplotypeCaller, Scalpel, and Octopus, reconstruct local genomic haplotypes directly from sequencing reads, helping resolve complex variants more effectively. Additionally, newer methods employ variation graphs—data structures that represent multiple known variants simultaneously—to improve alignment accuracy and variant calling performance, particularly in regions of high genetic complexity or variability. These innovative approaches promise to significantly enhance the accuracy and comprehensiveness of genomic analyses moving forward.</p>
</section>
<section id="assessing-and-benchmarking-variant-calls" class="level3">
<h3 class="anchored" data-anchor-id="assessing-and-benchmarking-variant-calls">8. Assessing and Benchmarking Variant Calls</h3>
<p>The <strong>transition/transversion (Ts/Tv) ratio</strong> is a critical metric used to assess the quality of variant calls. Transitions (Ts)—base substitutions within purines (A↔︎G) or pyrimidines (C↔︎T)—occur more frequently than transversions (Tv), substitutions between purines and pyrimidines. For high-quality SNP datasets in humans, a Ts/Tv ratio of approximately 2 to 3 is typically expected; deviations from this range can indicate underlying errors in variant calling.</p>
<p>Another key consideration is the concept of a <strong>callable genome</strong>, as certain regions of the genome are inherently difficult to analyze due to repetitive sequences, structural complexities, or extreme GC content. Not all genomic regions are equally accessible or “callable,” and thus it is beneficial to utilize established benchmark sets, such as the Genome in a Bottle project, which define high-confidence genomic regions suitable for accurate variant detection and performance assessment.</p>
<p>When evaluating variant-calling performance, metrics such as <strong>precision and recall</strong> become essential. Precision represents the proportion of called variants that are correct (true positives), while recall, also known as sensitivity, measures the proportion of true variants correctly identified. To accurately compute these metrics, benchmarking tools like hap.py or vcfeval are routinely employed, allowing researchers to systematically assess and optimize variant-calling workflows for reliability and accuracy.</p>
</section>
<section id="functional-annotation-and-variant-consequences" class="level3">
<h3 class="anchored" data-anchor-id="functional-annotation-and-variant-consequences">9. Functional Annotation and Variant Consequences</h3>
<p>Functional annotation of genetic variants is an essential step in understanding their potential biological impacts. Annotation tools such as <strong>BCFtools/csq</strong>, <strong>Ensembl Variant Effect Predictor (VEP)</strong>, and <strong>ANNOVAR</strong> are commonly utilized to systematically determine the genomic context of variants, categorizing them as coding, intronic, untranslated region (UTR), or intergenic. These tools further predict the functional consequences of variants, distinguishing between synonymous changes, which do not alter the amino acid sequence, and non-synonymous or missense mutations, which result in amino acid substitutions. More severe mutations include nonsense variants, which introduce premature stop codons, and frameshift variants, which disrupt the reading frame of the protein. Variant pathogenicity is often classified into categories such as pathogenic, likely pathogenic, benign, likely benign, or variants of uncertain significance (VUS). These classifications integrate population frequency data, computational prediction models, family-based segregation analyses, and results from functional assays to provide meaningful insights into the clinical or biological relevance of each variant.</p>
</section>
<section id="population-level-variant-data" class="level3">
<h3 class="anchored" data-anchor-id="population-level-variant-data">10. Population-Level Variant Data</h3>
<p>Population-level variant datasets provide critical resources for interpreting genetic variation in a global context. The <strong>1000 Genomes Project</strong>, for instance, encompasses genomic data from over 2,500 individuals representing 26 distinct populations worldwide, with an average sequencing coverage of approximately 7–8X. This extensive collection offers researchers a comprehensive snapshot of human genetic diversity, aiding studies in population genetics, evolutionary biology, and clinical genomics.</p>
<p>Complementary to the 1000 Genomes Project, resources like <strong>HapMap</strong>, <strong>HGDP-CEPH</strong>, and <strong>gnomAD</strong> further enrich our understanding of global genetic variation. The International HapMap Project, although now archived, was an early effort aimed at cataloging common single nucleotide polymorphisms (SNPs) across diverse human populations. The HGDP-CEPH panel provides valuable genomic data from a broad array of worldwide populations, offering insights into human evolutionary history and population structure. The Genome Aggregation Database (gnomAD) expands upon these earlier efforts by compiling allele frequency data from tens of thousands of sequenced individuals, greatly enhancing our ability to interpret genetic variants, understand their functional significance, and accurately determine their frequencies across different populations.</p>
</section>
<section id="references-and-additional-resources" class="level3">
<h3 class="anchored" data-anchor-id="references-and-additional-resources">11. References and Additional Resources</h3>
<p>Olson, N.D., et al.&nbsp;(2023) Nature Reviews Genetics 24:464–483.</p>
<p>The 1000 Genomes Project Consortium. (2015) Nature 526:68–74.</p>
<p>Cann, H.M., et al.&nbsp;(2002) Science 296:261–262. (HGDP-CEPH)</p>
<p>Ensembl Variation documentation: https://www.ensembl.org/info/docs/variation/index.html</p>
<p>BCFtools: <a href="https://github.com/samtools/bcftools" class="uri">https://github.com/samtools/bcftools</a></p>
<p>VEP (Variant Effect Predictor): <a href="https://github.com/willmclaren/ensembl-vep" class="uri">https://github.com/willmclaren/ensembl-vep</a></p>
<p>gnomAD: <a href="https://gnomad.broadinstitute.org/about" class="uri">https://gnomad.broadinstitute.org/about</a></p>
<p>For course-related inquiries, contact: qasim.ayub@monash.edu</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../course_modules/Module2/module2_exercises.html" class="pagination-link" aria-label="Exercises">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Exercises</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../course_modules/Module3/module3_exercises.html" class="pagination-link" aria-label="Exercises">
        <span class="nav-page-text">Exercises</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>This work is licensed under a Creative Commons Attribution 4.0 International License. Reuse is encouraged with acknowledgement</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>