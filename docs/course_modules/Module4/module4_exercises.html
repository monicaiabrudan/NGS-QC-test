<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Exercises – Genome Sequence Analysis Course</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../course_modules/Module4/module4_solutions.html" rel="next">
<link href="../../course_modules/Module4/module4_manual.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../site_libs/quarto-contrib/quarto-project/img/WCS_Logo-Primary_Black.jpg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Genome Sequence Analysis Course</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../welcome.html"> 
<span class="menu-text">Learning paths</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-modules" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Modules</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-modules">    
        <li>
    <a class="dropdown-item" href="../../course_modules/Module1/module1.html">
 <span class="dropdown-text">File formats</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../course_modules/Module2/module2.html">
 <span class="dropdown-text">Reads alignment</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../course_modules/Module3/module3.html">
 <span class="dropdown-text">Variant calling</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../course_modules/Module4/module4.html">
 <span class="dropdown-text">Structural Variation Calling</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../course_modules/Module5/module5.html">
 <span class="dropdown-text">Genome assembly</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../course_modules/Module6/module6.html">
 <span class="dropdown-text">RNA-seq</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../course_modules/Module7/module7.html">
 <span class="dropdown-text">CHiP-Seq</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../course_modules/Glossary/glossary.html">
 <span class="dropdown-text">Glossary of terms</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-informatics-guide" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Informatics Guide</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-informatics-guide">    
        <li>
    <a class="dropdown-item" href="../../course_modules/VM_guide/VM_Guide.html">
 <span class="dropdown-text">How to setup a VM</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../course_modules/VM_guide/Software_list.html">
 <span class="dropdown-text">Software list</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-train-the-trainer" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Train-the-trainer</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-train-the-trainer">    
        <li>
    <a class="dropdown-item" href="../../course_modules/Train-the-trainer/introduction.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../course_modules/Train-the-trainer/strategies.html">
 <span class="dropdown-text">Strategies for training professionals</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../course_modules/Train-the-trainer/elements.html">
 <span class="dropdown-text">Elements of effective training</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../course_modules/Train-the-trainer/training_design.html">
 <span class="dropdown-text">Training design</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../course_modules/Module4/module4.html">Structural Variation Calling</a></li><li class="breadcrumb-item"><a href="../../course_modules/Module4/module4_exercises.html">Exercises</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">File formats</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module1/module1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module1/module1_manual.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Manual</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module1/module1_exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercises</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module1/module1_solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solutions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module1/module1_instructor_notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Instructor notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module1/module1_datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datasets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module1/module1_platform_guidance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Platform guidance</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Read alignment</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module2/module2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module2/module2_manual.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Manual</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module2/module2_exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercises</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module2/module2_solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solutions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module2/module2_instructor_notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Instructor notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module2/module2_datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datasets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module2/module2_platform_guidance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Platform guidance</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Variant calling</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module3/module3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module3/module3_manual.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Manual</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module3/module3_exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercises</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module3/module3_solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solutions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module3/module3_instructor_notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Instructor notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module3/module3_datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datasets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module3/module3_platform_guidance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Platform guidance</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Structural Variation Calling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module4/module4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module4/module4_manual.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Manual</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module4/module4_exercises.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Exercises</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module4/module4_solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solutions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module4/module4_instructor_notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Instructor notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module4/module4_datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datasets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module4/module4_platform_guidance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Platform guidance</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Genome Assembly</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module5/module5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module5/module5_manual.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Manual</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module5/module5_exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercises</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module5/module5_solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solutions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module5/module5_instructor_notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Instructor notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module5/module5_datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datasets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module5/module5_platform_guidance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Platform guidance</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">RNA-Seq</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module6/module6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module6/module6_manual.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Manual</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module6/module6_exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercises</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module6/module6_solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solutions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module6/module6_instructor_notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Instructor notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module6/module6_datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datasets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module6/module6_platform_guidance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Platform guidance</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">CHiP-Seq</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module7/module7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module7/module7_manual.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Manual</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module7/module7_exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercises</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module7/module7_solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solutions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module7/module7_instructor_notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Instructor notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module7/module7_datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datasets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Module7/module7_platform_guidance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Platform guidance</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false">
 <span class="menu-text">How to setup a VM</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/VM_guide/VM_Guide.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Oracle VM VirtualBox Installation Guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/VM_guide/Software_list.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Software list</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false">
 <span class="menu-text">Train-the-trainer</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Train-the-trainer/introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Train-the-trainer/strategies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Strategies for training professionals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Train-the-trainer/elements.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Elements of effective training</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course_modules/Train-the-trainer/training_design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Training design</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false">
 <span class="menu-text">Contributors</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../meet the team.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Acknowledgements</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#structural-variation-calling" id="toc-structural-variation-calling" class="nav-link active" data-scroll-target="#structural-variation-calling">Structural Variation Calling</a>
  <ul class="collapse">
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#tutorial-sections" id="toc-tutorial-sections" class="nav-link" data-scroll-target="#tutorial-sections">Tutorial sections</a></li>
  <li><a href="#running-the-commands-in-this-tutorial" id="toc-running-the-commands-in-this-tutorial" class="nav-link" data-scroll-target="#running-the-commands-in-this-tutorial">Running the commands in this tutorial</a></li>
  <li><a href="#lets-get-started" id="toc-lets-get-started" class="nav-link" data-scroll-target="#lets-get-started">Let’s get started!</a></li>
  </ul></li>
  <li><a href="#looking-at-structural-variants-in-vcf" id="toc-looking-at-structural-variants-in-vcf" class="nav-link" data-scroll-target="#looking-at-structural-variants-in-vcf">Looking at Structural Variants in VCF</a>
  <ul class="collapse">
  <li><a href="#excercises" id="toc-excercises" class="nav-link" data-scroll-target="#excercises">Excercises</a></li>
  </ul></li>
  <li><a href="#calling-structural-variants" id="toc-calling-structural-variants" class="nav-link" data-scroll-target="#calling-structural-variants">Calling Structural Variants</a>
  <ul class="collapse">
  <li><a href="#breakdancer" id="toc-breakdancer" class="nav-link" data-scroll-target="#breakdancer">Breakdancer</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises">Exercises</a></li>
  <li><a href="#inspecting-svs-with-igv" id="toc-inspecting-svs-with-igv" class="nav-link" data-scroll-target="#inspecting-svs-with-igv">Inspecting SVs with IGV</a></li>
  <li><a href="#exercises-1" id="toc-exercises-1" class="nav-link" data-scroll-target="#exercises-1">Exercises</a></li>
  <li><a href="#dysgu" id="toc-dysgu" class="nav-link" data-scroll-target="#dysgu">Dysgu</a></li>
  </ul></li>
  <li><a href="#calling-structural-variants-from-long-reads" id="toc-calling-structural-variants-from-long-reads" class="nav-link" data-scroll-target="#calling-structural-variants-from-long-reads">Calling Structural Variants from Long Reads</a>
  <ul class="collapse">
  <li><a href="#introducing-the-dataset" id="toc-introducing-the-dataset" class="nav-link" data-scroll-target="#introducing-the-dataset">Introducing the dataset</a></li>
  <li><a href="#align-the-data" id="toc-align-the-data" class="nav-link" data-scroll-target="#align-the-data">Align the data</a></li>
  <li><a href="#call-structural-variants" id="toc-call-structural-variants" class="nav-link" data-scroll-target="#call-structural-variants">Call structural variants</a></li>
  <li><a href="#inspecting-svs-with-igv-1" id="toc-inspecting-svs-with-igv-1" class="nav-link" data-scroll-target="#inspecting-svs-with-igv-1">Inspecting SVs with IGV</a></li>
  </ul></li>
  <li><a href="#bedtools" id="toc-bedtools" class="nav-link" data-scroll-target="#bedtools">Bedtools</a>
  <ul class="collapse">
  <li><a href="#bedtools-intersect" id="toc-bedtools-intersect" class="nav-link" data-scroll-target="#bedtools-intersect">bedtools intersect</a></li>
  <li><a href="#exercises-2" id="toc-exercises-2" class="nav-link" data-scroll-target="#exercises-2">Exercises</a></li>
  <li><a href="#bedtools-closest" id="toc-bedtools-closest" class="nav-link" data-scroll-target="#bedtools-closest">bedtools closest</a></li>
  <li><a href="#exercises-3" id="toc-exercises-3" class="nav-link" data-scroll-target="#exercises-3">Exercises</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../course_modules/Module4/module4.html">Structural Variation Calling</a></li><li class="breadcrumb-item"><a href="../../course_modules/Module4/module4_exercises.html">Exercises</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Exercises</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="structural-variation-calling" class="level2">
<h2 class="anchored" data-anchor-id="structural-variation-calling">Structural Variation Calling</h2>
<section id="introduction" class="level3">
<h3 class="anchored" data-anchor-id="introduction">Introduction</h3>
<p>Structural variants (SVs) are large genomic alterations of at least 50 bp or larger in size. There are several types of SVs, including deletions, duplications, insertions, inversions, and translocations which describe different combinations of DNA gains, losses, or rearrangements. Copy number variations (CNVs) are a particular subtype of SV mainly represented by deletions and duplications. SVs are typically described as single events, although more complex scenarios involving combinations of SV types exist.</p>
</section>
<section id="tutorial-sections" class="level3">
<h3 class="anchored" data-anchor-id="tutorial-sections">Tutorial sections</h3>
<p>This tutorial comprises the following sections:</p>
<p>1. Looking at structural variants in VCF</p>
<p>2. Calling structural variants</p>
<p>3. Structural variants from long reads</p>
<p>4. Bedtools</p>
</section>
<section id="running-the-commands-in-this-tutorial" class="level3">
<h3 class="anchored" data-anchor-id="running-the-commands-in-this-tutorial">Running the commands in this tutorial</h3>
<p>You can follow this tutorial by typing all the commands you see into a terminal window. This is similar to the “Command Prompt” window on MS Windows systems, which allows the user to type DOS commands to manage files. To get started, open a new terminal window and type the command below:</p>
<p><code>cd /home/manager/course_data/structural_variation/data</code></p>
</section>
<section id="lets-get-started" class="level3">
<h3 class="anchored" data-anchor-id="lets-get-started">Let’s get started!</h3>
<p>This tutorial requires that you have <strong>breakdancer</strong>, <strong>lumpy</strong>, <strong>minimap2</strong>, <strong>sniffles</strong>, <strong>bedtools</strong> and <strong>igv</strong> installed on your computer.</p>
<p>These are already installed on the virtual machine you are using. To check that these are installed, run the following commands:</p>
<p><code>breakdancer-max -h</code></p>
<p><code>dysgu --help</code></p>
<p><code>minimap2 --help</code></p>
<p><code>sniffles --help</code></p>
<p><code>bedtools --help</code></p>
<p>This should return the help message for software <strong>breakdancer, dysgu, minimap2, sniffles</strong> and <strong>bedtools</strong> respectively.</p>
<p>If after this course you would like to download and install this software the instructions can be found at the links below, alternatively we recommend <strong>bioconda</strong> for the installation and management of your bioinformatics software.</p>
<p>• The <a href="http://breakdancer.sourceforge.net/">breakdancer website</a></p>
<p>• The <a href="https://github.com/kcleal/dysgu">dysgu github page</a></p>
<p>• The <a href="https://lh3.github.io/minimap2/">minimap2 website</a></p>
<p>• The <a href="https://github.com/fritzsedlazeck/Sniffles/wiki">sniffles website</a></p>
<p>• The <a href="https://bedtools.readthedocs.io/">bedtools website</a></p>
<p>To get started with the tutorial, go to the first section: Looking at structural variants in VCF</p>
</section>
</section>
<section id="looking-at-structural-variants-in-vcf" class="level2">
<h2 class="anchored" data-anchor-id="looking-at-structural-variants-in-vcf">Looking at Structural Variants in VCF</h2>
<p>Structural variants can be stored in VCF files. In this part of the tutorial, we will look at how these are represented in a VCF file.</p>
<p>First, check you are in the correct directory:</p>
<p><code>pwd</code></p>
<p>It should display something like: <strong><em>/home/manager/course_data/structural_variation/data</em></strong></p>
<p>Navigate to the exercise1 directory:</p>
<p><code>cd exercise1</code></p>
<p>There is a VCF file called <strong>ERR1015121.vcf</strong> that was produced using the Lumpy SV calling software. Look at the VCF file using the less command and answer the questions that follow:</p>
<p><code>less ERR1015121.vcf</code></p>
<section id="excercises" class="level3">
<h3 class="anchored" data-anchor-id="excercises">Excercises</h3>
<p>1. What does the CIPOS format tag indicate?</p>
<p>2. What does the PE tag indicate?</p>
<p>3. What tag is used to describe an inversion event?</p>
<p>4. What tag is used to describe a duplication event?</p>
<p>5. How many deletions were called in total? (Hint: DEL is the info field for a deletion. The -c option of the grep command can be used to return a count of matches.)</p>
<p>6. What type of event is predicted at IV:437148? What is the length of the SV? How many paired-end reads and split-reads support this SV variant call?</p>
<p>7. What is the total number of SV calls predicted on the IV chromosome?</p>
<p>Now continue to the next section of the tutorial: Calling structural variants</p>
</section>
</section>
<section id="calling-structural-variants" class="level2">
<h2 class="anchored" data-anchor-id="calling-structural-variants">Calling Structural Variants</h2>
<p>There are several software tools available for calling structural variants. We will use two callers in this part of the tutorial, <strong>breakdancer</strong> and <strong>lumpy</strong></p>
<section id="breakdancer" class="level3">
<h3 class="anchored" data-anchor-id="breakdancer">Breakdancer</h3>
<p>BreakDancer predicts five types of structural variants: insertions (INS), deletions (DEL), inversions (INV), inter-chromosomal translocations (CTX) and intra-chromosomal translocations (ITX) from next-generation short paired-end sequencing reads using read pairs that are mapped with unexpected separation distances or orientation.</p>
<p>Navigate to the exercise2 directory:</p>
<p><code>cd ../exercise2</code></p>
<p><code>ls</code></p>
<p>We will use the <strong>Breakdancer</strong> software package to call structural variants on a yeast sample that was paired-end sequenced on the illumina HiSeq 2000. Breakdancer first needs to examine the BAM file to get information on the fragment size distribution for each sequencing library contained in the BAM file.</p>
<p>The <strong><em>breakdancer.config</em></strong> file has information about the sequencing library fragment size distribution. Use the <strong><em>cat</em></strong> command to print the contents of the <strong><em>breakdancer.config</em></strong> file.</p>
<p><strong>Q What is the mean and standard deviation of the fragment size?</strong></p>
<p>Run the breakdancer SV caller using the command:</p>
<p><code>breakdancer-max breakdancer.config &gt; ERR1015121.breakdancer.out</code></p>
<p>Look at the output of Breakdancer.</p>
<p><code>head ERR1015121.breakdancer.out</code></p>
<p>Note that the output from Breakdancer is NOT VCF format, instead it is a simple text format with one line per SV event.</p>
</section>
<section id="exercises" class="level3">
<h3 class="anchored" data-anchor-id="exercises">Exercises</h3>
<p>1. What type of SV event is predicted at position III:83065?</p>
<p>2. What is the size of this SV?</p>
<p>3. What is the score of this SV?</p>
<p>4. What type of SV event is predicted at position II:258766?</p>
<p>5. Convert the output of breakdancer into BED format</p>
</section>
<section id="inspecting-svs-with-igv" class="level3">
<h3 class="anchored" data-anchor-id="inspecting-svs-with-igv">Inspecting SVs with IGV</h3>
<p>The BED format is explained here: <a href="https://genome.ucsc.edu/FAQ/FAQformat.html#format1"><strong><em>https://genome.ucsc.edu/FAQ/FAQformat.html#format1</em></strong></a></p>
<p>To complete this task, create a command that:</p>
<p>1. Extracts all the deletions from the <strong><em>breakdancer.out</em></strong> file (Hint: use <strong><em>grep</em></strong>)</p>
<p>2. Prints columns: 1, 2, 5, 7, and 9 to create a BED file with columns: chromosome, start, end, name, and score. (Hint: use <strong><em>awk</em></strong> to do this, e.g.&nbsp;<strong><em>awk ’{print $1”</em></strong><em>*</em>”$2}’)***</p>
<p>3. Print the resulting bed output into a file called: <strong><em>breakdancer.dels.bed</em></strong></p>
<p>Now we will open the IGV genome browser and inspect some of the predicted structural variants. To do this type:</p>
<p><code>igv</code></p>
<p><strong>Open the reference genome</strong>: Go to ’ <strong><em>Genomes -&gt; Load Genome From Server…</em></strong> ’ and select “<strong><em>S. cerevisiae (SacCer3)</em></strong>”.</p>
<p><strong>Load the BAM file:</strong> Go to ’ File -&gt; Load from File… ‘. Select the “ERR1015121.bam” BAM file and click’ Open ’.</p>
<p><strong>Load the BED file for the deletion calls that you created in the exercise 5 above:</strong> Go to ’ File -&gt; Load from File… ‘. Select the “<strong><em>breakdancer.dels.bed</em></strong>” BED file and click’<strong><em>Open</em></strong>’.</p>
</section>
<section id="exercises-1" class="level3">
<h3 class="anchored" data-anchor-id="exercises-1">Exercises</h3>
<p>Using the navigation bar, go to region <strong>II:258,500-266,700.</strong></p>
<p>1. Can you see the structural variant? What type of structural variant is it? (Hint: you may need to zoom out a little to see the full structural variant).</p>
<p>2. Can you see any evidence to support this SV call?</p>
<p>3. Can you estimate the size of the SV? The VCF in the <strong>exercise1</strong> directory was produced by another structural variant caller on the same sample as this exercise.</p>
<p>4. Load the <strong><em>exercise1/ERR1015121.vcf</em></strong> VCF into IGV also (File - Load from file, and select ERR1015121.vcf in the exercise 1 directory).</p>
<p>5. Was the structural variant at <strong>II:258766</strong> also called by the other structural variant software (lumpy)? If so, what was the predicted size? Using the navigation bar, go to to region <strong>II:508,064-511,840</strong>.</p>
<p>6. Is there a SV deletion called in this region by either SV caller?</p>
<p>7. Is there any read support for a SV deletion in this region? If so, how many read pairs could support the deletion call (Hint: change the IGV view to s<em>quished</em> and <em>View as pairs</em> to see any inconsistently aligned read pairs).</p>
</section>
<section id="dysgu" class="level3">
<h3 class="anchored" data-anchor-id="dysgu">Dysgu</h3>
<p>We will use the <strong><em>Dysgu</em></strong> (pronounced <em>duss-key</em>) software package (<a href="https://github.com/kcleal/dysgu" class="uri">https://github.com/kcleal/dysgu</a>) to call structural variants on a yeast sample that was paired-end sequenced on the Illumina Hiseq 2000.</p>
<p>Dysgu is designed to take BAM files that have been aligned with BWA-mem.</p>
<p>Navigate to the exercise 3 directory:</p>
<p><code>cd ../exercise3</code></p>
<p><code>ls</code></p>
<p>Check that there is a BAM file called <strong><em>ERR1015069.bam</em></strong> and an index file <strong><em>ERR1015069.bam.bai</em></strong> in the directory. The sequence data has already been mapped with <strong><em>bwa mem</em></strong> and the results are stored in <strong><em>ERR1015069.bam.</em></strong></p>
<p>To call SVs, a sorted and indexed <strong><em>.bam/cram</em></strong> is needed plus an indexed reference genome (fasta format). Also a working directory must be provided to store temporary files.</p>
<p><code>dysgu run ../ref/Saccharomyces_cerevisiae.R64-1-1.dna.toplevel.fa temp ERR1015069.bam &gt; ERR1015069.vcf</code></p>
<p>Dysgu is a multi-stage pipeline</p>
<ul>
<li><p>The first stage of the “<em>run</em>” pipeline is to separate SV-associated reads - split/discordant reads, and reads with a soft-clip &gt;= clip_length (15 bp by default)</p></li>
<li><p>The next stage of the pipeline is to call and genotype SVs using the reads from the first stage. The run command above combines both of these stages together.</p></li>
</ul>
<p><strong>1. What was the total number of SVs identified? How many PASS SVs were identified by Dysgu? Why did the rest of the SVs fail?</strong></p>
<p><strong>2. What type of SV event occurs at position IV:384221? What is the length of the SV event? What is the genotype quality?</strong></p>
<p><strong>3. What type of SV event occurs at position XV:31115? What is the length of the SV event? What is the probability of the structural variant?</strong></p>
<p>Congratulations, you have sucessfully called structural variants from some NGS data. Now continue to the next section of the tutorial: Calling structural variants from long reads</p>
</section>
</section>
<section id="calling-structural-variants-from-long-reads" class="level2">
<h2 class="anchored" data-anchor-id="calling-structural-variants-from-long-reads">Calling Structural Variants from Long Reads</h2>
<p>In this part of the tutorial we will use long read data to identify structural variants using the SV caller <strong><em>Sniffles</em></strong>.</p>
<p>First navigate to the exercise4 directory:</p>
<p><code>cd ../exercise4</code></p>
<p><code>ls</code></p>
<section id="introducing-the-dataset" class="level3">
<h3 class="anchored" data-anchor-id="introducing-the-dataset">Introducing the dataset</h3>
<p>We will use data from a <em>Saccharomyces cerevisiae</em> strain (YPS128) that was sequenced at the Wellcome Sanger Institute and deposited in the ENA (Project: PRJEB7245, sample: SAMEA2757770, analysis: ERZ448241).</p>
<p>The sequencing reads are contained in a fastq file: <strong><em>YPS128.filtered_subreads.10x.fastq.gz</em></strong></p>
<p>The reference genome is in the <strong><em>../ref</em></strong> directory in a fasta file: <strong><em>Saccharomyces_cerevisiae.R64-1-1.dna.toplevel.fa</em></strong></p>
</section>
<section id="align-the-data" class="level3">
<h3 class="anchored" data-anchor-id="align-the-data">Align the data</h3>
<p>Before you can use <strong><em>Sniffles</em></strong> to call SVs, it is very important that the reads are aligned with an aligner suitable for long reads. The software <strong><em>minimap2</em></strong> is a long-read aligner designed to align PacBio or Oxford Nanopore (standard and ultra-long) to a reference genome. You can find the usage of <strong><em>minimap2</em></strong> by typing:</p>
<p><code>minimap2</code></p>
<p>Use minimap2 to align the reads and send the output to a SAM file called <strong><em>YPS128.filtered_sub- reads.10x.sam</em></strong></p>
<p>Note: use the <strong><em>-t</em></strong> option to use multiple threads in parallel (this will increase the speed of the alignment by using more than one CPU core, I suggest using 2).</p>
<p>Also look at the <strong><em>-x</em></strong> option. Convert the SAM file to BAM.</p>
<p>Sort the BAM file and produce a sorted BAM file called <strong><em>YPS128.filtered_subreads.10X.sorted.bam</em></strong>.</p>
<p>Hint: Use <strong><em>samtools sort</em></strong>.</p>
</section>
<section id="call-structural-variants" class="level3">
<h3 class="anchored" data-anchor-id="call-structural-variants">Call structural variants</h3>
<p>Use <strong><em>samtools calmd</em></strong> to calculates MD and NM tags. This enables variant calling without requiring access to the entire original reference.</p>
<p><code>samtools calmd -b YPS128.filtered_subreads.10x.sorted.bam ../ref/ Saccharomyces_cerevisiae.R64-1-1.dna.toplevel.fa &gt; YPS128.filtered_subreads.10x.fastq.sorted.calmd.bam</code></p>
<p>Finally, use <strong><em>samtools</em></strong> to index this BAM file.</p>
<p>Hint: Use <strong><em>samtools index</em></strong></p>
<p><strong>Sniffles</strong> is a structural variation (SV) caller that is designed for long reads (Pacbio or Oxford Nanopore). It detects all types of SVs (10bp+) using evidence from split-read alignments, high- mismatch regions, and coverage analysis. <strong>Sniffles</strong> takes the BAM file as input and outputs VCF.</p>
<p>To find the usage for Sniffles, type:</p>
<p><code>sniffles</code></p>
<p>Using the default parameters, call SVs with <strong>Sniffles</strong> and output the results to a VCF file called <strong><em>YPS128.10x.vcf</em></strong>.</p>
<p>Hint: You don’t need to change any of the default parameters, but you will need to work out how to provide the input BAM file and specify the output VCF file. The documentation on <strong>sniffles</strong> is here : <a href="https://github.com/fritzsedlazeck/Sniffles/wiki/Parameter" class="uri">https://github.com/fritzsedlazeck/Sniffles/wiki/Parameter</a></p>
</section>
<section id="inspecting-svs-with-igv-1" class="level3">
<h3 class="anchored" data-anchor-id="inspecting-svs-with-igv-1">Inspecting SVs with IGV</h3>
<p>Open IGV:</p>
<p><code>igv</code></p>
<p>Open the reference genome <strong><em>ref/Saccharomyces_cerevisiae.R64-1-1.dna.toplevel.fa</em></strong> and load the BAM file <strong><em>YPS128.filtered_subreads.10x.fastq.sorted.calmd.bam</em></strong> and the VCF file <strong><em>YPS128.filtered_subreads.10x.vcf</em></strong>.</p>
<p>Now answer the questions that follow using either the command line or IGV.</p>
<p><strong>1. What sort of SV was called at on chromosome ‘XV’ at position 854272?</strong></p>
<p><strong>2. What is the length of the SV?</strong></p>
<p><strong>3. How many reads are supporting the SV?</strong></p>
<p><strong>4. What sort of SV was called at on chromosome ‘XI’ at position 74608?</strong></p>
<p><strong>5. What is the length of the SV?</strong></p>
<p><strong>6. How many reads are supporting the SV?</strong></p>
<p><strong>7. How many inversions were called in the VCF? Note inversions are denoted by the type ‘INV’.</strong></p>
<p><strong>8. How many duplications were called in the VCF? Note duplications are denoted by the type ‘DUP’.</strong></p>
<p>Now continue to the next section of the tutorial: <strong>bedtools</strong>.</p>
</section>
</section>
<section id="bedtools" class="level2">
<h2 class="anchored" data-anchor-id="bedtools">Bedtools</h2>
<p><strong>Bedtools</strong> is an extremely useful tool for doing regional comparisons over genomic coordinates. It has many commands for doing region based comparisons with BAM, VCF, GFF, BED file formats.</p>
<p>To see the list of commands available, on the command line type:</p>
<p><code>bedtools</code></p>
<p>Navigate to the exercise5 directory:</p>
<p><code>cd ../exercise5</code></p>
<p><code>ls</code></p>
<p>In this directory, there are two VCF files and the yeast genome annotation in <strong>GFF3</strong> format <strong>Saccharomyces_cerevisiae.R64-1-1.82.genes.gff3</strong>.</p>
<section id="bedtools-intersect" class="level3">
<h3 class="anchored" data-anchor-id="bedtools-intersect">bedtools intersect</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/bedtools intersect.png" class="img-fluid figure-img"></p>
<figcaption>(Credit to Aaron Quinlan for original source of figure: http://quinlanlab.org/tutorials/bedtool- s/bedtools.html)</figcaption>
</figure>
</div>
<p>Given two sets of genomic features, the <strong>bedtools intersect</strong> command can be used to determine whether or not any of the features in the two sets “overlap” with one another. For the intersect command, the <strong><em>-a</em></strong> and <strong><em>-b</em></strong> parameters are used to denote the input files <strong>A</strong> and <strong>B</strong>.</p>
<p>For example, to find out the overlap between the SVs in <strong><em>ERR1015069.dels.vcf</em></strong> and the annotated region of the yeast genome try</p>
<p>This command reports the variant in the file <strong><em>ERR1015069.dels.vcf</em></strong> every time it overlaps with a feature in <strong><em>Saccharomyces_cerevisiae.R64-1-1.82.genes.gff3</em></strong>.</p>
<p>Therefore if a variant overlaps more than one feature it will be reported more than once. To report the unique set of variants use:</p>
<p>bedtools intersect -a ERR1015069.dels.vcf -b Saccharomyces_cerevisiae.R64-1-1.82.genes.gff3</p>
<p><code>bedtools intersect -u -a ERR1015069.dels.vcf -b Saccharomyces_cerevisiae.R64-1- 1.82.genes.gff3</code></p>
<p>The default is to report overlaps between features in <strong>A</strong> and <strong>B</strong> so long as at least one base pair of overlap exists. However, the <strong>-f</strong> option allows you to specify what fraction of each feature in <strong>A</strong> should be overlapped by a feature in <strong>B</strong> before it is reported.</p>
<p>To specify a more strict intersect and require at least 25% of overlap of the SV with the genes use the command:</p>
<p><em>bedtools intersect -u -f 0.25 -a ERR1015069.dels.vcf -b Saccharomyces_cerevisiae.R64-1-1.82.genes.gff3</em></p>
<p>The <strong><em>bedtools intersect</em></strong> command can also be used to determine how many SVs overlap between two VCF files. For more information about <strong><em>bedtools intersect</em></strong> see the help:</p>
<p>bedtools intersect -h</p>
</section>
<section id="exercises-2" class="level3">
<h3 class="anchored" data-anchor-id="exercises-2">Exercises</h3>
<p>1. <strong>How many SVs found in ERR1015069.dels.vcf overlap with a gene? (Hint: Use bedtools intersect command)</strong></p>
<p><strong>2. How many SVs found in ERR1015069.dels.vcf do not overlap with a gene? (Hint: note the -v parameter to bedtools intersect)</strong></p>
<p><strong>3. How many SVs found in ERR1015069.dels.vcf overlap with a more strict definition of 50%?</strong></p>
<p><strong>4. How many features does the deletion at VII:811446 overlap with? What type of genes? Note you will need to also use the -wb option in bedtools intersect.</strong></p>
<p><strong>5. How many features does the deletion at XII:650823 overlap with? What type of genes? Note you will need to also use the -wb option in bedtools intersect.</strong></p>
</section>
<section id="bedtools-closest" class="level3">
<h3 class="anchored" data-anchor-id="bedtools-closest">bedtools closest</h3>
<p>Similar to intersect, <strong><em>bedtools closest</em></strong> searches for overlapping features in <strong>A</strong> and <strong>B</strong>. In the event that no feature in <strong>B</strong> overlaps the current feature in <strong>A,</strong> closest will report the nearest (that is, least genomic distance from the start or end of <strong>A</strong>) feature in <strong>B</strong>.</p>
<p>An example of the usage of <strong>bedtools closest</strong> is:</p>
<p><code>bedtools closest -d -a ERR1015069.dels.vcf -b Saccharomyces_cerevisiae.R64-1-1.82.genes.gff3</code></p>
<p>This command will list all the features in the file <strong><em>Saccharomyces_cerevisiae.R64-1- 1.82.genes.gff3</em></strong> that are closest to each of the variants in <strong><em>ERR1015069.dels.vcf.</em></strong> The <strong>-d</strong> option means that in addition to the closest feature in <strong><em>Saccharomyces_cerevisiae.R64-1- 1.82.genes.gff3</em></strong>, the distance to the variant in <strong><em>ERR1015069.dels.vcf</em></strong> will be reported as an extra column. The reported distance for any overlapping features will be 0.</p>
<p>For example, to find the closest gene to the variant found at position <strong><em>43018</em></strong> on chromosome <strong><em>XV</em></strong>, try:</p>
<p><code>bedtools closest -d -a ERR1015069.dels.vcf -b Saccharomyces_cerevisiae.R64-1-1.82.genes.gff3| grep XV | grep 43018</code></p>
<p>For more information about <strong><em>bedtools closest</em></strong> see the help:</p>
<p><code>bedtools closest -h</code></p>
</section>
<section id="exercises-3" class="level3">
<h3 class="anchored" data-anchor-id="exercises-3">Exercises</h3>
<p><strong>6. What is the closest gene to the structural variant at IV:384220 in ERR1015069.dels.vcf?</strong></p>
<p><strong>7. How many SVs overlap between the two files ERR1015069.dels.vcf and ERR1015121.dels.vcf?</strong></p>
<p><strong>8. How many SVs have a 50% reciprocal overlap between the two files ERR1015069.dels.vcf and ERR1015121.dels.vcf (Hint: first find the option for reciprocal overlap by typing: bedtools intersect -h)</strong></p>
<p>Congratulations, you have reached the end of the tutorial</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../course_modules/Module4/module4_manual.html" class="pagination-link" aria-label="Manual">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Manual</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../course_modules/Module4/module4_solutions.html" class="pagination-link" aria-label="Solutions">
        <span class="nav-page-text">Solutions</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>This work is licensed under a Creative Commons Attribution 4.0 International License. Reuse is encouraged with acknowledgement</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>